zabbix_export:
  version: '6.0'
  date: '2021-11-25T12:38:01Z'
  groups:
    -
      uuid: 7df96b18c230490a9a0a9e2307226338
      name: Templates
    -
      uuid: 57b7ae836ca64446ba2c296389c009b7
      name: Templates/Modules
  templates:
    -
      uuid: a56467298d234dab95c3c46818da5a50
      template: 'Sophos XG FW 18 SNMPv2'
      name: 'Sophos XG FW 18 SNMPv2'
      templates:
        -
          name: 'Template Module Generic SNMP'
        -
          name: 'Template Module HOST-RESOURCES-MIB CPU SNMP'
        -
          name: 'Template Module Interfaces SNMP'
      groups:
        -
          name: Templates
      items:
        -
          uuid: a0e42558cf2a40689c9d07a36277f9c5
          name: 'Service apache status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosApacheService.0'
          key: apacheService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 9db252f6eef641b9a2efe88d6713e682
              expression: 'last(/Sophos XG FW 18 SNMPv2/apacheService)<>3'
              name: 'Service apache status is not running'
              priority: AVERAGE
        -
          uuid: c787069898f645f2a3508422a09970db
          name: 'Device serial number'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDeviceAppKey.0'
          key: applianceKey
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: bb2b1b5e99ca4ca08cc06e1bce776eb5
          name: 'Device name'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDeviceName.0'
          key: applianceName
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 831891b634554bbfa2d74e79a0fcca7b
          name: 'Device type'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDeviceType.0'
          key: applianceType
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 457e70b505594df8a6982e3d49d35200
          name: 'Service AS status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosASService.0'
          key: asService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 5c88c2b8c7f54d80ad16812d026636d0
              expression: 'last(/Sophos XG FW 18 SNMPv2/asService)<>3 and last(/Sophos XG FW 18 SNMPv2/asService)<>7'
              name: 'Service as status is not running'
              priority: AVERAGE
        -
          uuid: 9c5c43d682824de1b66e9fddf46ffca6
          name: 'Service AV status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosAVService.0'
          key: avService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 470b2a86d79d4c5fb4000a0073f58ffd
              expression: 'last(/Sophos XG FW 18 SNMPv2/avService)<>3'
              name: 'Service av status is not running'
              priority: AVERAGE
        -
          uuid: 7cf4de765b9943209c333ead127a2e9c
          name: 'Base license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosBaseFWLicExpiryDate.0'
          key: baseFWLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'Base Firewall protection license expiry date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: 22e940ea0a45422cb01d6a9dcaf7e9ea
          name: 'Base license reg status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosBaseFWLicRegStatus.0'
          key: baseFWLicRegStatus
          delay: 1h
          history: 2w
          description: 'Base Firewall protection license status.'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: d5c5cbbf53724cb3b07224de46743773
          name: 'HA current status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDeviceCurrentHAState.0'
          key: currentHAStatus
          delay: 5m
          history: 45d
          trends: 150d
          description: |
            Textual Convention: HaStatus
            Values: 	notapplicable( 0 ), auxiliary( 1 ), standAlone( 2 ), primary( 3 ), faulty( 4 ), ready ( 5 )
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::haStatus'
          tags:
            -
              tag: Application
              value: Status
        -
          uuid: 9e34f1ec07864be5857a658a766cb927
          name: 'Service database status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDatabaseservice.0'
          key: databaseService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 88c4ae55f95e452fabb66c8537571be6
              expression: 'last(/Sophos XG FW 18 SNMPv2/databaseService)<>3'
              name: 'Service database status is not running'
              priority: AVERAGE
        -
          uuid: b739fcaf33cc4d13b4a8c0fe2f8234f6
          name: 'Service Dgd status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDgdService.0'
          key: dgdService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 97d9bb5effbf43219c3d40b23a46c66e
              expression: 'last(/Sophos XG FW 18 SNMPv2/dgdService)<>3'
              name: 'Service dgd status is not running'
              priority: AVERAGE
        -
          uuid: e502a195374c4099b29025fd057a4ca8
          name: 'Disk capacity'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDiskCapacity.0'
          key: diskCapacity
          delay: 1h
          history: 2w
          trends: 150d
          units: B
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 6c79a36871724838ba9d2cd126e8d12b
          name: 'Disk utilization'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDiskPercentUsage.0'
          key: diskPercentUsage
          delay: 5m
          history: 45d
          trends: 150d
          units: '%'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: a71895e9b33f4f1a85a848500e9b11d7
              expression: 'avg(/Sophos XG FW 18 SNMPv2/diskPercentUsage,5m)>{$DISK_UTIL_MAX}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/Sophos XG FW 18 SNMPv2/diskPercentUsage,5m)<({$DISK_UTIL_MAX}-5)'
              name: 'Disk utilization high'
              priority: HIGH
        -
          uuid: b5553ad05b8c4d2ab4e1c4b39852a475
          name: 'Service dns status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDNSService.0'
          key: dnsService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 570d371e715648f99f2fcdfe6ff80a3b
              expression: 'last(/Sophos XG FW 18 SNMPv2/dnsService)<>3'
              name: 'Service dns status is not running'
              priority: AVERAGE
        -
          uuid: da8445cc6f2c4cd4ac08edd1ab83f4a0
          name: 'Service drouting status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDroutingService.0'
          key: droutingService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 2450fbcfded74e9aa8395fa40f7de16d
              expression: 'last(/Sophos XG FW 18 SNMPv2/droutingService)<>3'
              name: 'Service drouting status is not running'
              priority: AVERAGE
        -
          uuid: 80f731da0f534fdc86286e4842915e02
          name: 'Firmware version'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosDeviceFWVersion.0'
          key: firewallVersion
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Version of Intrusion Detection and Prevention (IDP)'
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: 155c2f3cd52c47878f98bfed0f17bf7f
              expression: '(last(/Sophos XG FW 18 SNMPv2/firewallVersion,#1)<>last(/Sophos XG FW 18 SNMPv2/firewallVersion,#2))=1'
              recovery_mode: NONE
              name: 'Firmware version changed'
              priority: INFO
              description: 'Ack to manual close'
              manual_close: 'YES'
        -
          uuid: 6cb1abdb1696470388af014e48314d55
          name: 'Service FTP status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosFtpService.0'
          key: ftpService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 7e5fab28b8d6462fae29d0c0a6e6c005
              expression: 'last(/Sophos XG FW 18 SNMPv2/ftpService)<>3'
              name: 'Service ftp status is not running'
              priority: AVERAGE
        -
          uuid: d096d47417c0432f83f5dc33f9e75fa4
          name: 'Service garner status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosGarnerService.0'
          key: garnerService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: c88c177fd03c42bbb4a1e5c0b9ad4d18
              expression: 'last(/Sophos XG FW 18 SNMPv2/garnerService)<>3'
              name: 'Service garner status is not running'
              priority: AVERAGE
        -
          uuid: be68a2d6f2314b1b999e70a5579b509a
          name: 'HA mode'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosHAStatus.0'
          key: haMode
          delay: 5m
          history: 45d
          trends: 150d
          description: |
            Textual Convention: HaStatusType
            Values: disabled(0), enabled(1)
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::haStatusType'
          tags:
            -
              tag: Application
              value: Status
        -
          uuid: e3d528919fe14c8d88f723613512a741
          name: 'Service HA status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosHAService.0'
          key: haService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 6076df48f7824d8eb3a537a9d4276738
              expression: 'last(/Sophos XG FW 18 SNMPv2/haService)<>3 and last(/Sophos XG FW 18 SNMPv2/haService)<>0'
              name: 'Service ha status is not running'
              priority: AVERAGE
        -
          uuid: a755d3a0c73049b2b964701176eb5f4e
          name: 'HTTP Hits'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosHTTPHits.0'
          key: httpHits
          delay: 3m
          history: 2w
          trends: '0'
          tags:
            -
              tag: Application
              value: Statistic
        -
          uuid: c23cdb696dc04e5f94b133d8c0874f8b
          name: 'Service HTTP status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosHttpService.0'
          key: httpService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 650b2b8b4ff041a6b38ffe99a3e419cc
              expression: 'last(/Sophos XG FW 18 SNMPv2/httpService)<>3'
              name: 'Service http status is not running'
              priority: AVERAGE
        -
          uuid: 1adfdbfd8b2f4ac3b1412f9087798091
          name: 'Service IMAP4 status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosImap4Service.0'
          key: imap4Service
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 4d12683199664c55b8712eaaa2e33ca1
              expression: 'last(/Sophos XG FW 18 SNMPv2/imap4Service)<>3'
              name: 'Service imap4 status is not running'
              priority: AVERAGE
        -
          uuid: 93a35c596b524b8b898b59753faf9e21
          name: 'IMAP Hits'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosImapHits.0'
          key: imapHits
          delay: 3m
          history: 2w
          trends: '0'
          tags:
            -
              tag: Application
              value: Statistic
        -
          uuid: 5f17462bf3a04756bad7f0acb17057aa
          name: 'Service IP-Sec VPN status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosIPSecVpnService.0'
          key: ipSecVpnService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: c1e963825dae4cca873c85f4bcfd6c69
              expression: 'last(/Sophos XG FW 18 SNMPv2/ipSecVpnService)<>3'
              name: 'Service IP-Sec VPN status is not running'
              priority: AVERAGE
        -
          uuid: 8b50c1849f874bb0a402a5f086fc4764
          name: 'Service IPS status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosIPSService.0'
          key: ipsService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 4f00a6ac522949c4bcdd5a3fedac3642
              expression: 'last(/Sophos XG FW 18 SNMPv2/ipsService)<>3'
              name: 'Service IPS status is not running'
              priority: AVERAGE
        -
          uuid: 613af45615c2488a9e142ffa41447d20
          name: 'IDS version'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosIPSVersion.0'
          key: ipsVersion
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Version of Intrusion Detection and Prevention (IDP)'
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 47ff3a9829b9416db93e3909a4984f57
          name: 'Live user count'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosLiveUsersCount.0'
          key: liveUserCount
          delay: 3m
          history: 2w
          trends: '0'
          tags:
            -
              tag: Application
              value: Statistic
        -
          uuid: dc3322e6fd3146cdb162eeb869de7d51
          name: 'Mail Protection license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosMailProtectionLicExpiryDate.0'
          key: mailProtectionLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'EMail Protection Iicense Expiry Date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: 93eefea9696e4ed4b3cc15ade32f6cfe
          name: 'Mail Protection license reg status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosMailProtectionLicRegStatus.0'
          key: mailProtectionLicRegStatus
          delay: 1h
          history: 2w
          description: 'EMail Protection license status.'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
          triggers:
            -
              uuid: 06605798c37240b4bf991f35da6d7f05
              expression: 'last(/Sophos XG FW 18 SNMPv2/mailProtectionLicRegStatus)=4'
              name: 'Mail Protection license reg status'
              url: 'https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&filter_hostids%5B%5D={HOST.ID}&filter_application=License&select=&filter_set=1'
              priority: AVERAGE
              description: 'Mail Protection license is expired.'
        -
          uuid: 29b2b484c5b84ebe8a4fb1f55b5706b5
          name: 'Memory capacity'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosMemoryCapacity.0'
          key: memoryCapacity
          delay: 1h
          history: 2w
          trends: 150d
          units: B
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 7cd5747370d94effa65c77291b510b75
          name: 'Memory utilization'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosMemoryPercentUsage.0'
          key: memoryPercentUsage
          history: 45d
          trends: 150d
          units: '%'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: ae9e29f031d849b28b78b92205f9d2c8
              expression: 'avg(/Sophos XG FW 18 SNMPv2/memoryPercentUsage,15m)>{$MEMORY_UTIL_MAX}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/Sophos XG FW 18 SNMPv2/memoryPercentUsage,5m)<({$MEMORY_UTIL_MAX}-5)'
              name: 'Memory utilization high'
              priority: HIGH
        -
          uuid: 03f0608b3aa842778e4892d5e1ee1407
          name: 'Network Protection license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosNetProtectionLicExpiryDate.0'
          key: netProtectionLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'Network Protection Iicense Expiry Date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: 65f26b366deb4a8a9693ba0e87cb4007
          name: 'Network Protection reg license status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosNetProtectionLicRegStatus.0'
          key: netProtectionLicRegStatus
          delay: 1h
          history: 2w
          description: 'Network Protection registration license status'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
          triggers:
            -
              uuid: 415a093833754a62ad1e43a9a826ecfa
              expression: 'last(/Sophos XG FW 18 SNMPv2/netProtectionLicRegStatus)=4'
              name: 'Network Protection reg license status'
              url: 'https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&filter_hostids%5B%5D={HOST.ID}&filter_application=License&select=&filter_set=1'
              priority: AVERAGE
              description: 'Network Protection reg status is expired.'
        -
          uuid: 4ed354985ea1425d921ff206999e6c5a
          name: 'Service network status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosNetworkService.0'
          key: networkService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 114ae58cdf0e4cfcb0ea893249bf1c12
              expression: 'last(/Sophos XG FW 18 SNMPv2/networkService)<>3'
              name: 'Service network status is not running'
              priority: AVERAGE
        -
          uuid: 9b504930948c4b9ab48aae1df35aa995
          name: 'Service NTP status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosNtpService.0'
          key: ntpService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 56f3074eeb6b47e9b245ee33c915b077
              expression: 'last(/Sophos XG FW 18 SNMPv2/ntpService)<>3 and last(/Sophos XG FW 18 SNMPv2/ntpService)<>7'
              name: 'Service ntp status is not running'
              priority: AVERAGE
        -
          uuid: 77f5e48f2102454b87e67852b04ded5e
          name: 'POP3 Hits'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosPOP3Hits.0'
          key: pop3Hits
          delay: 3m
          history: 2w
          trends: '0'
          tags:
            -
              tag: Application
              value: Statistic
        -
          uuid: 52062d12a71f4290b2b6c5fa9c33e4ac
          name: 'Service POP3 status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB:sfosPoP3Service.0'
          key: pop3Service
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: c49bfddab9cf48898a4432d860a4e103
              expression: 'last(/Sophos XG FW 18 SNMPv2/pop3Service)<>3'
              name: 'Service pop3 status is not running'
              priority: AVERAGE
        -
          uuid: baea9674cf59404abac7a2be66034e89
          name: 'Sandstrom license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSandstromLicExpiryDate.0'
          key: sandstromLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'Sandstrom Protection Iicense Expiry Date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: 987083be42354d798daa7cbd3e74d1e7
          name: 'Sandstrom license reg status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSandstromLicRegStatus.0'
          key: sandstromLicRegStatus
          delay: 1h
          history: 2w
          description: 'Sandstrom Protection Iicense status.'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
          triggers:
            -
              uuid: 3f6717a97c044996b288565fcb7e0833
              expression: 'last(/Sophos XG FW 18 SNMPv2/sandstromLicRegStatus)=4'
              name: 'Sandstrom license reg status'
              url: 'https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&filter_hostids%5B%5D={HOST.ID}&filter_application=License&select=&filter_set=1'
              priority: AVERAGE
              description: 'Sandstrom Protection licensereg status is expired.'
        -
          uuid: 65b8511e3be949daa738ae5907928ed7
          name: 'SMTP Hits'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSmtpHits.0'
          key: smtpHits
          delay: 3m
          history: 2w
          trends: '0'
          tags:
            -
              tag: Application
              value: Statistic
        -
          uuid: dc94e24cce224751ac7458c73245263c
          name: 'Service SMTP status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSmtpService.0'
          key: smtpService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: c125a46cf16c4cecba492601e523165f
              expression: 'last(/Sophos XG FW 18 SNMPv2/smtpService)<>3'
              name: 'Service smtp status is not running'
              priority: AVERAGE
        -
          uuid: 48711218d2194d2cbe663866674159db
          name: 'Service sshd status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSSHdService.0'
          key: sshdService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 0dfa51ae8bcf452b976fe2711577eb8b
              expression: 'last(/Sophos XG FW 18 SNMPv2/sshdService)<>3 and last(/Sophos XG FW 18 SNMPv2/sshdService)<>0'
              name: 'Service sshd status is not running'
              priority: AVERAGE
        -
          uuid: ec3d7120179a4a718c9afcdead394c63
          name: 'Service SSL-VPN status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB:sfosSSLVpnService.0'
          key: sslvpnService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: ac2f108b59384cd8bb717b2b442fb2c4
              expression: 'last(/Sophos XG FW 18 SNMPv2/sslvpnService)<>3 and last(/Sophos XG FW 18 SNMPv2/sslvpnService)<>7'
              name: 'Service sslvpn status is not running'
              priority: AVERAGE
        -
          uuid: a1c261d91ba340a983627242cc353eba
          name: 'Swap capacity'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSwapCapacity.0'
          key: swapCapacity
          delay: 1h
          history: 2w
          trends: 150d
          units: B
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1048576'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 977d4899014f49fb857211d18e35fae5
          name: 'Swap utilization'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosSwapPercentUsage.0'
          key: swapPercentUsage
          delay: 5m
          history: 45d
          trends: 150d
          units: '%'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: 4070f56c1d2b4ba59e1c15ff35e8bab7
              expression: 'avg(/Sophos XG FW 18 SNMPv2/swapPercentUsage,5m)>{$SWAP_UTIL_MAX}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'avg(/Sophos XG FW 18 SNMPv2/swapPercentUsage,5m)<({$SWAP_UTIL_MAX}-5)'
              name: 'Swap utilization high'
              priority: HIGH
        -
          uuid: 397c40e201bd48fda682ec8bd526f5e6
          name: 'Service tomcat status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosTomcatService.0'
          key: tomcatService
          delay: 5m
          history: 2w
          trends: '0'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          tags:
            -
              tag: Application
              value: Services
          triggers:
            -
              uuid: 8693e663850642cd87cc3230473ae875
              expression: 'last(/Sophos XG FW 18 SNMPv2/tomcatService)<>3'
              name: 'Service tomcat status is not running'
              priority: AVERAGE
        -
          uuid: 6c6f58d4f5ab488195cc788129b5b376
          name: 'Webcat version'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosWebcatVersion.0'
          key: webcatVersion
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'Version of Webcat'
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 6620c94ec8f749b69218dbfaa75bf7f1
          name: 'Web Protection license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosWebProtectionLicExpiryDate.0'
          key: webProtectionLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'Web Protection license expiry date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: d1592989d9df45fe816ab545e4a461e6
          name: 'Web Protection license reg status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosWebProtectionLicRegStatus.0'
          key: webProtectionLicRegStatus
          delay: 1h
          history: 2w
          description: 'Web Protection registration license status.'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
          triggers:
            -
              uuid: 89676ed3ee31483595987848fd2a3cbe
              expression: 'last(/Sophos XG FW 18 SNMPv2/webProtectionLicRegStatus)=4'
              name: 'Web Protection license reg status'
              url: 'https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&filter_hostids%5B%5D={HOST.ID}&filter_application=License&select=&filter_set=1'
              priority: AVERAGE
              description: 'Web Protection license reg staus is expired.'
        -
          uuid: 986b8b4c1acb453eae1cd7f1a235ca3d
          name: 'WebServer Protection license expire date'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosWebServerProtectionLicExpiryDate.0'
          key: webServerProtectionLicExpiryDate
          delay: 1h
          history: 2w
          trends: '0'
          value_type: TEXT
          description: 'WebServer Protection Iicense Expiry Date.'
          tags:
            -
              tag: Application
              value: License
        -
          uuid: 5d6eb3fa9f464b778dfbd82dfd2058d7
          name: 'WebServer Protection license reg status'
          type: SNMP_AGENT
          snmp_oid: 'SFOS-FIREWALL-MIB::sfosWebServerProtectionLicRegStatus.0'
          key: webServerProtectionLicRegStatus
          delay: 1h
          history: 2w
          description: 'WebServer Protection license status.'
          valuemap:
            name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          tags:
            -
              tag: Application
              value: License
          triggers:
            -
              uuid: 8686faca5ec542adbde3e2e395049a61
              expression: 'last(/Sophos XG FW 18 SNMPv2/webServerProtectionLicRegStatus)=4'
              name: 'WebServer Protection license reg status'
              url: 'https://{$ZABBIX_DNS}/zabbix.php?action=latest.view&filter_hostids%5B%5D={HOST.ID}&filter_application=License&select=&filter_set=1'
              priority: AVERAGE
              description: 'WebServer Protection license reg status is expired.'
      macros:
        -
          macro: '{$CPU_UTIL_MAX}'
          value: '95'
        -
          macro: '{$DISK_UTIL_MAX}'
          value: '90'
        -
          macro: '{$MEMORY_UTIL_MAX}'
          value: '90'
        -
          macro: '{$SNMP_COMMUNITY}'
          value: public
        -
          macro: '{$SWAP_UTIL_MAX}'
          value: '90'
      dashboards:
        -
          uuid: 62e24e3fda7e4f76bdc42a5a2b71e10c
          name: 'Network interfaces'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                        host: 'Sophos XG FW 18 SNMPv2'
      valuemaps:
        -
          uuid: a414f9f7407940e7b95b4438fa7881bb
          name: 'SOPHOS SFOS-FIREWALL-MIB::haStatus'
          mappings:
            -
              value: '0'
              newvalue: notapplicable
            -
              value: '1'
              newvalue: auxiliary
            -
              value: '2'
              newvalue: standAlone
            -
              value: '3'
              newvalue: primary
            -
              value: '4'
              newvalue: faulty
            -
              value: '5'
              newvalue: ready
        -
          uuid: 191a88baff1744c8a316b9f0561715b0
          name: 'SOPHOS SFOS-FIREWALL-MIB::haStatusType'
          mappings:
            -
              value: '0'
              newvalue: disabled
            -
              value: '1'
              newvalue: enabled
        -
          uuid: 425f9340398e43aeb7214e918e091784
          name: 'SOPHOS SFOS-FIREWALL-MIB::serviceStatus'
          mappings:
            -
              value: '0'
              newvalue: untouched
            -
              value: '1'
              newvalue: stopped
            -
              value: '2'
              newvalue: initializing
            -
              value: '3'
              newvalue: running
            -
              value: '4'
              newvalue: exiting
            -
              value: '5'
              newvalue: dead
            -
              value: '6'
              newvalue: frozen
            -
              value: '7'
              newvalue: unregistered
        -
          uuid: cb9af1193bab4fffb6a080e859417ee3
          name: 'SOPHOS SFOS-FIREWALL-MIB::subscriptionStatusType'
          mappings:
            -
              value: '1'
              newvalue: trial
            -
              value: '2'
              newvalue: unsubscribed
            -
              value: '3'
              newvalue: subscribed
            -
              value: '4'
              newvalue: expired
    -
      uuid: 4cb1aabe2b704b5c882963c2ef87d8f6
      template: 'Template Module Generic SNMP'
      name: 'Template Module Generic SNMP'
      description: |
        Template Module Generic
        
        MIBs used:
        SNMPv2-MIB
        
        Template tooling version used: 0.36
      templates:
        -
          name: 'Template Module ICMP Ping'
      groups:
        -
          name: Templates/Modules
      items:
        -
          uuid: 2cda26906f254e13985cecdbb7901d1a
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          history: 2w
          trends: '0'
          value_type: LOG
          description: 'Item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            -
              tag: Application
              value: General
        -
          uuid: 62da59c7aae54df7976f327119fe7cc2
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: General
        -
          uuid: 29a3e5277de94386a5985fcf38a09364
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: General
        -
          uuid: 02b453f44c014f2bb1054e801058b381
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The physical location of this node (e.g., `telephone closet, 3rd floor').  If the location is unknown, the value is the zero-length string.
          inventory_link: LOCATION
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
        -
          uuid: 3996a3a8d927473aa07c47e63a09b865
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
          triggers:
            -
              uuid: 072bf35ea9d04c559ada5cb13d4b6802
              expression: '(last(/Template Module Generic SNMP/system.name,#1)<>last(/Template Module Generic SNMP/system.name,#2))=1 and length(last(/Template Module Generic SNMP/system.name))>0'
              name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'System name has changed. Ack to close.'
              manual_close: 'YES'
        -
          uuid: 9dbcc5a1cd7240c896e2ea718f9ccb35
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 15m
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          tags:
            -
              tag: Application
              value: General
        -
          uuid: 000b97abddcd44bfb57e0eeb1b77f69e
          name: Uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.uptime[sysUpTime.0]'
          delay: 30s
          history: 2w
          trends: 0d
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            The time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: 6f00359af55f45909bdecbad234c7654
              expression: 'last(/Template Module Generic SNMP/system.uptime[sysUpTime.0])<10m'
              name: '{HOST.NAME} has been restarted (uptime < 10m)'
              priority: WARNING
              description: 'Uptime is less than 10 minutes'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'No SNMP data collection'
                  expression: 'max(/Template Module Generic SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
        -
          uuid: 3e8c2d440441416b9ccec7dd90e21503
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          history: 7d
          valuemap:
            name: zabbix.host.available
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: d3aba975ec574b258c7f971152c5d4cd
              expression: 'max(/Template Module Generic SNMP/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              dependencies:
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Module Generic SNMP/icmpping,#3)=0'
      macros:
        -
          macro: '{$SNMP.TIMEOUT}'
          value: 5m
      valuemaps:
        -
          uuid: ced60845a741400390ba002e69e26b0f
          name: zabbix.host.available
          mappings:
            -
              value: '0'
              newvalue: 'not available'
            -
              value: '1'
              newvalue: available
            -
              value: '2'
              newvalue: unknown
    -
      uuid: b3dd7c4974f442d68c53a79056bc5388
      template: 'Template Module HOST-RESOURCES-MIB CPU SNMP'
      name: 'Template Module HOST-RESOURCES-MIB CPU SNMP'
      description: |
        Requires Zabbix server 4.0.14, 4.2.8, 4.4.0 or newer (JSONPath function avg() used with types autoconversion).
        
        MIBs used:
        HOST-RESOURCES-MIB
        
        Template tooling version used: 0.36
      groups:
        -
          name: Templates/Modules
      items:
        -
          uuid: 76b66d024509446ea4e7a48439f8d406
          name: 'CPU utilization'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#CPU.UTIL},1.3.6.1.2.1.25.3.3.1.2]'
          key: system.cpu.util
          history: 7d
          value_type: FLOAT
          units: '%'
          description: |
            MIB: HOST-RESOURCES-MIB
            The average, over the last minute, of the percentage of time that processors was not idle.
            Implementations may approximate this one minute smoothing period if necessary.
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - '$..[''{#CPU.UTIL}''].avg()'
          tags:
            -
              tag: Application
              value: CPU
          triggers:
            -
              uuid: bb8b2193ed4c437284d569a38f500367
              expression: 'min(/Template Module HOST-RESOURCES-MIB CPU SNMP/system.cpu.util,5m)>{$CPU.UTIL.CRIT}'
              name: 'High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'CPU utilization is too high. The system might be slow to respond.'
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
    -
      uuid: 37e5eb5606bc4abba66c8b20381a1e8a
      template: 'Template Module ICMP Ping'
      name: 'Template Module ICMP Ping'
      description: 'Template Module ICMP Ping version: 0.12'
      groups:
        -
          name: Templates/Modules
      items:
        -
          uuid: db5a94f6cea14deba957202b2f014469
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          delay: '60'
          history: 1w
          valuemap:
            name: 'Service state'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: b030876299434f3ba43e11c584104a81
              expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
              name: 'Unavailable by ICMP ping'
              priority: HIGH
              description: |
                Last value: {ITEM.LASTVALUE1}.
                Last three attempts returned timeout.  Please check device connectivity.
        -
          uuid: 04b21adaf422473a88df2c52786474ed
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          delay: '60'
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: 42c4b0310aaf4b9c8cb502542b7dea90
              expression: 'min(/Template Module ICMP Ping/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Module ICMP Ping/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              priority: WARNING
              dependencies:
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
        -
          uuid: a79e33e5fd264725b934f603fa071555
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          delay: '60'
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            -
              tag: Application
              value: Status
          triggers:
            -
              uuid: 32b4d8f3eba34bd380803410111d4b7f
              expression: 'avg(/Template Module ICMP Ping/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              priority: WARNING
              dependencies:
                -
                  name: 'High ICMP ping loss'
                  expression: 'min(/Template Module ICMP Ping/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Template Module ICMP Ping/icmppingloss,5m)<100'
                -
                  name: 'Unavailable by ICMP ping'
                  expression: 'max(/Template Module ICMP Ping/icmpping,#3)=0'
      macros:
        -
          macro: '{$ICMP_LOSS_WARN}'
          value: '20'
        -
          macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
      valuemaps:
        -
          uuid: bdb5d65d925542eaa61c302dc40fbfe8
          name: 'Service state'
          mappings:
            -
              value: '0'
              newvalue: Down
            -
              value: '1'
              newvalue: Up
    -
      uuid: 809cd59886464ff3ad0a66d16fb1f2d8
      template: 'Template Module Interfaces SNMP'
      name: 'Template Module Interfaces SNMP'
      description: |
        Template Module Interfaces
        
        MIBs used:
        IF-MIB
        
        Template tooling version used: 0.36
      groups:
        -
          name: Templates/Modules
      discovery_rules:
        -
          uuid: ea9babbf98cf48688aa00faf500e171e
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              -
                macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              -
                macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: I
              -
                macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: J
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: G
              -
                macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.MATCHES}'
                formulaid: E
              -
                macro: '{#IFDESCR}'
                value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              -
                macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              -
                macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.MATCHES}'
                formulaid: K
              -
                macro: '{#IFTYPE}'
                value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: L
          description: 'Discovering interfaces from IF-MIB.'
          item_prototypes:
            -
              uuid: 2ba24b3517aa4dbfb2d56f9e6c082668
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 2c7296aa56884ef48bb66c25097848f9
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 633cdf45222b454198ec66308aa7a55d
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: baca586b493448959a945c9433c38fe7
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 2712f191e05046da85321c0ceeea85b3
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 9037dd45e90a45baa58014d20db3ab0f
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              delay: 3m
              history: 7d
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: b63cb94bb9954ee4ab56d2a7d25d5957
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 5m
              history: 7d
              trends: 0d
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1000000'
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 0ac3b237358a4df69712d3829341766b
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: 35d62eb5323141a3a3f3afc4c9250243
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: |
                    This trigger expression works as follows:
                    1. Can be triggered if operations status is down.
                    2. {$IFCONTROL:"{#IFNAME}"}=1 - user can redefine Context macro to value - 0. That marks this interface as not important. No new trigger will be fired if this interface is down.
                    3. {TEMPLATE_NAME:METRIC.diff()}=1) - trigger fires only if operational status was up(1) sometime before. (So, do not fire 'ethernal off' interfaces.)
                    
                    WARNING: if closed manually - won't fire again on next poll, because of .diff.
                  manual_close: 'YES'
            -
              uuid: 565967032d23436486868eb495f7ed17
              name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}'
              key: 'net.if.type[ifType.{#SNMPINDEX}]'
              delay: 1h
              history: 7d
              trends: 0d
              description: |
                MIB: IF-MIB
                The type of interface.
                Additional values for ifType are assigned by the Internet Assigned NumbersAuthority (IANA),
                through updating the syntax of the IANAifType textual convention.
              valuemap:
                name: 'IF-MIB::ifType'
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
          trigger_prototypes:
            -
              uuid: 9f1f6cff58454b469f588af8624f9078
              expression: |
                change(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
                and (
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
                last(/Template Module Interfaces SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
                )
                and
                (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                (change(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
                (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
              name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed than it was before'
              opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'This Ethernet connection has transitioned down from its known maximum speed. This might be a sign of autonegotiation issues. Ack to close.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
            -
              uuid: 8983bc17e84640f89a8873961fa43ad2
              expression: |
                (avg(/Template Module Interfaces SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Template Module Interfaces SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Template Module Interfaces SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Template Module Interfaces SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Template Module Interfaces SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (> {$IF.UTIL.MAX:"{#IFNAME}"}% )'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
            -
              uuid: 255dd0daa3364a078f422ca36636f6a0
              expression: |
                min(/Template Module Interfaces SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Template Module Interfaces SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Template Module Interfaces SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Template Module Interfaces SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (> {$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Template Module Interfaces SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2 or {$IFCONTROL:"{#IFNAME}"}=0'
          graph_prototypes:
            -
              uuid: 748719ae10ea43da9efec7225dac54cb
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  drawtype: BOLD_LINE
                  color: 2774A4
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: F63100
                  yaxisside: RIGHT
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: A54F10
                  yaxisside: RIGHT
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
                -
                  sortorder: '4'
                  color: FC6EA3
                  yaxisside: RIGHT
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
                -
                  sortorder: '5'
                  color: 6C59DC
                  yaxisside: RIGHT
                  item:
                    host: 'Template Module Interfaces SNMP'
                    key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
      macros:
        -
          macro: '{$IF.ERRORS.WARN}'
          value: '2'
        -
          macro: '{$IF.UTIL.MAX}'
          value: '90'
        -
          macro: '{$IFCONTROL}'
          value: '1'
        -
          macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
          description: 'Ignore notPresent(6)'
        -
          macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        -
          macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        -
          macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        -
          macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: '(^Software Loopback Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})'
          description: 'Filter out loopbacks, nulls, docker veth links and docker0 bridge by default'
        -
          macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        -
          macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        -
          macro: '{$NET.IF.IFTYPE.MATCHES}'
          value: '.*'
        -
          macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
      dashboards:
        -
          uuid: b06fc59c5e744962b1ac5314e7e12cec
          name: 'Network interfaces'
          pages:
            -
              widgets:
                -
                  type: GRAPH_PROTOTYPE
                  width: '24'
                  height: '5'
                  fields:
                    -
                      type: INTEGER
                      name: source_type
                      value: '2'
                    -
                      type: INTEGER
                      name: columns
                      value: '1'
                    -
                      type: INTEGER
                      name: rows
                      value: '1'
                    -
                      type: GRAPH_PROTOTYPE
                      name: graphid
                      value:
                        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
                        host: 'Template Module Interfaces SNMP'
      valuemaps:
        -
          uuid: 692e46f1836c4e2682a0dc882fec89a0
          name: 'IF-MIB::ifOperStatus'
          mappings:
            -
              value: '1'
              newvalue: up
            -
              value: '2'
              newvalue: down
            -
              value: '3'
              newvalue: testing
            -
              value: '4'
              newvalue: unknown
            -
              value: '5'
              newvalue: dormant
            -
              value: '6'
              newvalue: notPresent
            -
              value: '7'
              newvalue: lowerLayerDown
        -
          uuid: 7a288ac5cdbf429b9d568b12b312ad70
          name: 'IF-MIB::ifType'
          mappings:
            -
              value: '1'
              newvalue: other
            -
              value: '2'
              newvalue: regular1822
            -
              value: '3'
              newvalue: hdh1822
            -
              value: '4'
              newvalue: ddnX25
            -
              value: '5'
              newvalue: rfc877x25
            -
              value: '6'
              newvalue: ethernetCsmacd
            -
              value: '7'
              newvalue: iso88023Csmacd
            -
              value: '8'
              newvalue: iso88024TokenBus
            -
              value: '9'
              newvalue: iso88025TokenRing
            -
              value: '10'
              newvalue: iso88026Man
            -
              value: '11'
              newvalue: starLan
            -
              value: '12'
              newvalue: proteon10Mbit
            -
              value: '13'
              newvalue: proteon80Mbit
            -
              value: '14'
              newvalue: hyperchannel
            -
              value: '15'
              newvalue: fddi
            -
              value: '16'
              newvalue: lapb
            -
              value: '17'
              newvalue: sdlc
            -
              value: '18'
              newvalue: ds1
            -
              value: '19'
              newvalue: e1
            -
              value: '20'
              newvalue: basicISDN
            -
              value: '21'
              newvalue: primaryISDN
            -
              value: '22'
              newvalue: propPointToPointSerial
            -
              value: '23'
              newvalue: ppp
            -
              value: '24'
              newvalue: softwareLoopback
            -
              value: '25'
              newvalue: eon
            -
              value: '26'
              newvalue: ethernet3Mbit
            -
              value: '27'
              newvalue: nsip
            -
              value: '28'
              newvalue: slip
            -
              value: '29'
              newvalue: ultra
            -
              value: '30'
              newvalue: ds3
            -
              value: '31'
              newvalue: sip
            -
              value: '32'
              newvalue: frameRelay
            -
              value: '33'
              newvalue: rs232
            -
              value: '34'
              newvalue: para
            -
              value: '35'
              newvalue: arcnet
            -
              value: '36'
              newvalue: arcnetPlus
            -
              value: '37'
              newvalue: atm
            -
              value: '38'
              newvalue: miox25
            -
              value: '39'
              newvalue: sonet
            -
              value: '40'
              newvalue: x25ple
            -
              value: '41'
              newvalue: iso88022llc
            -
              value: '42'
              newvalue: localTalk
            -
              value: '43'
              newvalue: smdsDxi
            -
              value: '44'
              newvalue: frameRelayService
            -
              value: '45'
              newvalue: v35
            -
              value: '46'
              newvalue: hssi
            -
              value: '47'
              newvalue: hippi
            -
              value: '48'
              newvalue: modem
            -
              value: '49'
              newvalue: aal5
            -
              value: '50'
              newvalue: sonetPath
            -
              value: '51'
              newvalue: sonetVT
            -
              value: '52'
              newvalue: smdsIcip
            -
              value: '53'
              newvalue: propVirtual
            -
              value: '54'
              newvalue: propMultiplexor
            -
              value: '55'
              newvalue: ieee80212
            -
              value: '56'
              newvalue: fibreChannel
            -
              value: '57'
              newvalue: hippiInterface
            -
              value: '58'
              newvalue: frameRelayInterconnect
            -
              value: '59'
              newvalue: aflane8023
            -
              value: '60'
              newvalue: aflane8025
            -
              value: '61'
              newvalue: cctEmul
            -
              value: '62'
              newvalue: fastEther
            -
              value: '63'
              newvalue: isdn
            -
              value: '64'
              newvalue: v11
            -
              value: '65'
              newvalue: v36
            -
              value: '66'
              newvalue: g703at64k
            -
              value: '67'
              newvalue: g703at2mb
            -
              value: '68'
              newvalue: qllc
            -
              value: '69'
              newvalue: fastEtherFX
            -
              value: '70'
              newvalue: channel
            -
              value: '71'
              newvalue: ieee80211
            -
              value: '72'
              newvalue: ibm370parChan
            -
              value: '73'
              newvalue: escon
            -
              value: '74'
              newvalue: dlsw
            -
              value: '75'
              newvalue: isdns
            -
              value: '76'
              newvalue: isdnu
            -
              value: '77'
              newvalue: lapd
            -
              value: '78'
              newvalue: ipSwitch
            -
              value: '79'
              newvalue: rsrb
            -
              value: '80'
              newvalue: atmLogical
            -
              value: '81'
              newvalue: ds0
            -
              value: '82'
              newvalue: ds0Bundle
            -
              value: '83'
              newvalue: bsc
            -
              value: '84'
              newvalue: async
            -
              value: '85'
              newvalue: cnr
            -
              value: '86'
              newvalue: iso88025Dtr
            -
              value: '87'
              newvalue: eplrs
            -
              value: '88'
              newvalue: arap
            -
              value: '89'
              newvalue: propCnls
            -
              value: '90'
              newvalue: hostPad
            -
              value: '91'
              newvalue: termPad
            -
              value: '92'
              newvalue: frameRelayMPI
            -
              value: '93'
              newvalue: x213
            -
              value: '94'
              newvalue: adsl
            -
              value: '95'
              newvalue: radsl
            -
              value: '96'
              newvalue: sdsl
            -
              value: '97'
              newvalue: vdsl
            -
              value: '98'
              newvalue: iso88025CRFPInt
            -
              value: '99'
              newvalue: myrinet
            -
              value: '100'
              newvalue: voiceEM
            -
              value: '101'
              newvalue: voiceFXO
            -
              value: '102'
              newvalue: voiceFXS
            -
              value: '103'
              newvalue: voiceEncap
            -
              value: '104'
              newvalue: voiceOverIp
            -
              value: '105'
              newvalue: atmDxi
            -
              value: '106'
              newvalue: atmFuni
            -
              value: '107'
              newvalue: atmIma
            -
              value: '108'
              newvalue: pppMultilinkBundle
            -
              value: '109'
              newvalue: ipOverCdlc
            -
              value: '110'
              newvalue: ipOverClaw
            -
              value: '111'
              newvalue: stackToStack
            -
              value: '112'
              newvalue: virtualIpAddress
            -
              value: '113'
              newvalue: mpc
            -
              value: '114'
              newvalue: ipOverAtm
            -
              value: '115'
              newvalue: iso88025Fiber
            -
              value: '116'
              newvalue: tdlc
            -
              value: '117'
              newvalue: gigabitEthernet
            -
              value: '118'
              newvalue: hdlc
            -
              value: '119'
              newvalue: lapf
            -
              value: '120'
              newvalue: v37
            -
              value: '121'
              newvalue: x25mlp
            -
              value: '122'
              newvalue: x25huntGroup
            -
              value: '123'
              newvalue: trasnpHdlc
            -
              value: '124'
              newvalue: interleave
            -
              value: '125'
              newvalue: fast
            -
              value: '126'
              newvalue: ip
            -
              value: '127'
              newvalue: docsCableMaclayer
            -
              value: '128'
              newvalue: docsCableDownstream
            -
              value: '129'
              newvalue: docsCableUpstream
            -
              value: '130'
              newvalue: a12MppSwitch
            -
              value: '131'
              newvalue: tunnel
            -
              value: '132'
              newvalue: coffee
            -
              value: '133'
              newvalue: ces
            -
              value: '134'
              newvalue: atmSubInterface
            -
              value: '135'
              newvalue: l2vlan
            -
              value: '136'
              newvalue: l3ipvlan
            -
              value: '137'
              newvalue: l3ipxvlan
            -
              value: '138'
              newvalue: digitalPowerline
            -
              value: '139'
              newvalue: mediaMailOverIp
            -
              value: '140'
              newvalue: dtm
            -
              value: '141'
              newvalue: dcn
            -
              value: '142'
              newvalue: ipForward
            -
              value: '143'
              newvalue: msdsl
            -
              value: '144'
              newvalue: ieee1394
            -
              value: '145'
              newvalue: if-gsn
            -
              value: '146'
              newvalue: dvbRccMacLayer
            -
              value: '147'
              newvalue: dvbRccDownstream
            -
              value: '148'
              newvalue: dvbRccUpstream
            -
              value: '149'
              newvalue: atmVirtual
            -
              value: '150'
              newvalue: mplsTunnel
            -
              value: '151'
              newvalue: srp
            -
              value: '152'
              newvalue: voiceOverAtm
            -
              value: '153'
              newvalue: voiceOverFrameRelay
            -
              value: '154'
              newvalue: idsl
            -
              value: '155'
              newvalue: compositeLink
            -
              value: '156'
              newvalue: ss7SigLink
            -
              value: '157'
              newvalue: propWirelessP2P
            -
              value: '158'
              newvalue: frForward
            -
              value: '159'
              newvalue: rfc1483
            -
              value: '160'
              newvalue: usb
            -
              value: '161'
              newvalue: ieee8023adLag
            -
              value: '162'
              newvalue: bgppolicyaccounting
            -
              value: '163'
              newvalue: frf16MfrBundle
            -
              value: '164'
              newvalue: h323Gatekeeper
            -
              value: '165'
              newvalue: h323Proxy
            -
              value: '166'
              newvalue: mpls
            -
              value: '167'
              newvalue: mfSigLink
            -
              value: '168'
              newvalue: hdsl2
            -
              value: '169'
              newvalue: shdsl
            -
              value: '170'
              newvalue: ds1FDL
            -
              value: '171'
              newvalue: pos
            -
              value: '172'
              newvalue: dvbAsiIn
            -
              value: '173'
              newvalue: dvbAsiOut
            -
              value: '174'
              newvalue: plc
            -
              value: '175'
              newvalue: nfas
            -
              value: '176'
              newvalue: tr008
            -
              value: '177'
              newvalue: gr303RDT
            -
              value: '178'
              newvalue: gr303IDT
            -
              value: '179'
              newvalue: isup
            -
              value: '180'
              newvalue: propDocsWirelessMaclayer
            -
              value: '181'
              newvalue: propDocsWirelessDownstream
            -
              value: '182'
              newvalue: propDocsWirelessUpstream
            -
              value: '183'
              newvalue: hiperlan2
            -
              value: '184'
              newvalue: propBWAp2Mp
            -
              value: '185'
              newvalue: sonetOverheadChannel
            -
              value: '186'
              newvalue: digitalWrapperOverheadChannel
            -
              value: '187'
              newvalue: aal2
            -
              value: '188'
              newvalue: radioMAC
            -
              value: '189'
              newvalue: atmRadio
            -
              value: '190'
              newvalue: imt
            -
              value: '191'
              newvalue: mvl
            -
              value: '192'
              newvalue: reachDSL
            -
              value: '193'
              newvalue: frDlciEndPt
            -
              value: '194'
              newvalue: atmVciEndPt
            -
              value: '195'
              newvalue: opticalChannel
            -
              value: '196'
              newvalue: opticalTransport
            -
              value: '197'
              newvalue: propAtm
            -
              value: '198'
              newvalue: voiceOverCable
            -
              value: '199'
              newvalue: infiniband
            -
              value: '200'
              newvalue: teLink
            -
              value: '201'
              newvalue: q2931
            -
              value: '202'
              newvalue: virtualTg
            -
              value: '203'
              newvalue: sipTg
            -
              value: '204'
              newvalue: sipSig
            -
              value: '205'
              newvalue: docsCableUpstreamChannel
            -
              value: '206'
              newvalue: econet
            -
              value: '207'
              newvalue: pon155
            -
              value: '208'
              newvalue: pon622
            -
              value: '209'
              newvalue: bridge
            -
              value: '210'
              newvalue: linegroup
            -
              value: '211'
              newvalue: voiceEMFGD
            -
              value: '212'
              newvalue: voiceFGDEANA
            -
              value: '213'
              newvalue: voiceDID
            -
              value: '214'
              newvalue: mpegTransport
            -
              value: '215'
              newvalue: sixToFour
            -
              value: '216'
              newvalue: gtp
            -
              value: '217'
              newvalue: pdnEtherLoop1
            -
              value: '218'
              newvalue: pdnEtherLoop2
            -
              value: '219'
              newvalue: opticalChannelGroup
            -
              value: '220'
              newvalue: homepna
            -
              value: '221'
              newvalue: gfp
            -
              value: '222'
              newvalue: ciscoISLvlan
            -
              value: '223'
              newvalue: actelisMetaLOOP
            -
              value: '224'
              newvalue: fcipLink
            -
              value: '225'
              newvalue: rpr
            -
              value: '226'
              newvalue: qam
            -
              value: '227'
              newvalue: lmp
            -
              value: '228'
              newvalue: cblVectaStar
            -
              value: '229'
              newvalue: docsCableMCmtsDownstream
            -
              value: '230'
              newvalue: adsl2
            -
              value: '231'
              newvalue: macSecControlledIF
            -
              value: '232'
              newvalue: macSecUncontrolledIF
            -
              value: '233'
              newvalue: aviciOpticalEther
            -
              value: '234'
              newvalue: atmbond
            -
              value: '235'
              newvalue: voiceFGDOS
            -
              value: '236'
              newvalue: mocaVersion1
            -
              value: '237'
              newvalue: ieee80216WMAN
            -
              value: '238'
              newvalue: adsl2plus
            -
              value: '239'
              newvalue: dvbRcsMacLayer
            -
              value: '240'
              newvalue: dvbTdm
            -
              value: '241'
              newvalue: dvbRcsTdma
            -
              value: '242'
              newvalue: x86Laps
            -
              value: '243'
              newvalue: wwanPP
            -
              value: '244'
              newvalue: wwanPP2
            -
              value: '245'
              newvalue: voiceEBS
            -
              value: '246'
              newvalue: ifPwType
            -
              value: '247'
              newvalue: ilan
            -
              value: '248'
              newvalue: pip
            -
              value: '249'
              newvalue: aluELP
            -
              value: '250'
              newvalue: gpon
            -
              value: '251'
              newvalue: vdsl2
            -
              value: '252'
              newvalue: capwapDot11Profile
            -
              value: '253'
              newvalue: capwapDot11Bss
            -
              value: '254'
              newvalue: capwapWtpVirtualRadio
            -
              value: '255'
              newvalue: bits
            -
              value: '256'
              newvalue: docsCableUpstreamRfPort
            -
              value: '257'
              newvalue: cableDownstreamRfPort
            -
              value: '258'
              newvalue: vmwareVirtualNic
            -
              value: '259'
              newvalue: ieee802154
            -
              value: '260'
              newvalue: otnOdu
            -
              value: '261'
              newvalue: otnOtu
            -
              value: '262'
              newvalue: ifVfiType
            -
              value: '263'
              newvalue: g9981
            -
              value: '264'
              newvalue: g9982
            -
              value: '265'
              newvalue: g9983
            -
              value: '266'
              newvalue: aluEpon
            -
              value: '267'
              newvalue: aluEponOnu
            -
              value: '268'
              newvalue: aluEponPhysicalUni
            -
              value: '269'
              newvalue: aluEponLogicalLink
            -
              value: '270'
              newvalue: aluGponOnu
            -
              value: '271'
              newvalue: aluGponPhysicalUni
            -
              value: '272'
              newvalue: vmwareNicTeam
            -
              value: '277'
              newvalue: docsOfdmDownstream
            -
              value: '278'
              newvalue: docsOfdmaUpstream
            -
              value: '279'
              newvalue: gfast
            -
              value: '280'
              newvalue: sdci
            -
              value: '281'
              newvalue: xboxWireless
            -
              value: '282'
              newvalue: fastdsl
            -
              value: '283'
              newvalue: docsCableScte55d1FwdOob
            -
              value: '284'
              newvalue: docsCableScte55d1RetOob
            -
              value: '285'
              newvalue: docsCableScte55d2DsOob
            -
              value: '286'
              newvalue: docsCableScte55d2UsOob
            -
              value: '287'
              newvalue: docsCableNdf
            -
              value: '288'
              newvalue: docsCableNdr
            -
              value: '289'
              newvalue: ptm
            -
              value: '290'
              newvalue: ghn
  graphs:
    -
      uuid: fe501ac6688d4165a645ef804644cf93
      name: 'CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Template Module HOST-RESOURCES-MIB CPU SNMP'
            key: system.cpu.util
