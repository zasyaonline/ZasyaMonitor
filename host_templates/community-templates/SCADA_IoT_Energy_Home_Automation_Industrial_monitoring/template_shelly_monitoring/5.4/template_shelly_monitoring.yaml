zabbix_export:
  version: '5.4'
  date: '2021-10-06T11:12:17Z'
  groups:
    group:
      - uuid: f609ef9a7ec748ae8ceb88ad929b7613
        name: Shelly
      - uuid: 36bff6c29af64692839d077febfc7079
        name: Templates/Network devices
  templates:
    template:
      - uuid: d51f33db1b344222937b67babcb6e413
        template: Template Shelly 3EM
        name: Template Shelly 3EM
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: de03f0507a144c6da565a56786ab4d6a
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 68f14def577c497bb3bdbb71fb695c38
                  expression: change(/Template Shelly 3EM/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: a21f6ddc42904976924d71cdb015cd1a
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 27a323790e134f329e739c4e0ba643fe
                  expression: change(/Template Shelly 3EM/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 546908a545d740e1b61f7c55eb48c35d
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 8eeeaf26835f4a45b5cec41272f3b7f7
                  expression: change(/Template Shelly 3EM/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 067400d321f642faae01689eb526b492
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 0a9e33bf4a9e44d3adc52dcb93c0520f
                  expression: change(/Template Shelly 3EM/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: f31be186fee947e2a83309d5c41ecc7d
              name: Electric company electrometer estimate
              type: DEPENDENT
              key: ec_em_estimate
              delay: '0'
              history: 1825d
              status: DISABLED
              value_type: FLOAT
              units: Wh
              description: >-
                Estimated value of electric company electrometer. This value may
                differ from real value due to device restarts or incorrect
                measurements. This estimate is only useful when your Shelly 3EM
                is measuring power consumption on the main breaker.


                For this value to show correct estimate, you have to take a note
                of how many Wh were on electric company electrometer when you
                reset Shelly 3EM data and put this value into macro
                {$EC_EM_CONSUMPTION}.
              preprocessing:
                step:
                  type: JAVASCRIPT
                  parameters:
                    parameter: >-
                      var json_data = JSON.parse(value);


                      var ec_emeter_offset  = 0;


                      var emeter_a_consumed = 0;

                      var emeter_b_consumed = 0;

                      var emeter_c_consumed = 0;

                      var emeter_n_consumed = 0;


                      var emeter_a_returned = 0;

                      var emeter_b_returned = 0;

                      var emeter_c_returned = 0;

                      var emeter_n_returned = 0;


                      var ec_em_consumed= '{$EC_EM_CONSUMPTION}';


                      if (ec_em_consumed == '' || ec_em_consumed == null ||
                      ec_em_consumed === undefined) {
                        ec_em_consumed = 0;
                      } else {
                        try {
                          ec_em_consumed = parseInt(ec_em_consumed);
                        } catch (e) {
                          ec_em_consumed = 0;
                        }
                      }


                      ec_emeter_offset = ec_em_consumed;


                      if (json_data.emeters[0]) {
                        emeter_a_consumed = json_data.emeters[0].total;
                      }

                      if (json_data.emeters[1]) {
                        emeter_b_consumed = json_data.emeters[1].total;
                      }

                      if (json_data.emeters[2]) {
                        emeter_c_consumed = json_data.emeters[2].total;
                      }

                      if (json_data.emeters[3]) {
                        emeter_n_consumed = json_data.emeters[3].total;
                      }


                      if (json_data.emeters[0]) {
                        emeter_a_returned = json_data.emeters[0].total_returned;
                      }

                      if (json_data.emeters[1]) {
                        emeter_b_returned = json_data.emeters[1].total_returned;
                      }

                      if (json_data.emeters[2]) {
                        emeter_c_returned = json_data.emeters[2].total_returned;
                      }

                      if (json_data.emeters[3]) {
                        emeter_n_returned = json_data.emeters[3].total_returned;
                      }


                      return ec_emeter_offset + ((emeter_a_consumed +
                      emeter_b_consumed + emeter_c_consumed + emeter_n_consumed)
                      - (emeter_a_returned + emeter_b_returned +
                      emeter_c_returned + emeter_n_returned));
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Electrometer summary
            - uuid: 93aeda6f098b4641b570ff9bb6d5d208
              name: Electrometer A current
              type: DEPENDENT
              key: emeters-0.current
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: A
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].current'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: 2f63a07439bd43aa8a3ba601247aa393
              name: Electrometer A self-check
              type: DEPENDENT
              key: emeters-0.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.emeters[0].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
                  - tag: Application
                    value: Self-check
            - uuid: 338f4f9f3bf34906a501958ad4638719
              name: Electrometer A power factor
              type: DEPENDENT
              key: emeters-0.pf
              delay: '0'
              history: 365d
              value_type: FLOAT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].pf'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: 930f124b03eb402da67471eab0b903a0
              name: Electrometer A power
              type: DEPENDENT
              key: emeters-0.power
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].power'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: 4da9e08cdaa446e7871d710c99f0587a
              name: Electrometer A total consumed
              type: DEPENDENT
              key: emeters-0.total
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].total'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: 0ca029344f99473dbec61b4775427098
              name: Electrometer A total returned
              type: DEPENDENT
              key: emeters-0.total_returned
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].total_returned'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: e45f922cf4314a26bcead1dbf0aec6be
              name: Electrometer A voltage
              type: DEPENDENT
              key: emeters-0.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[0].voltage'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer A
                  - tag: Application
                    value: Electrometers
            - uuid: f8886e4ca43f45e5b9d724fcde6be0b0
              name: Electrometer B current
              type: DEPENDENT
              key: emeters-1.current
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: A
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].current'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: 5fcee5d8db084acc90d668c4182dc5a7
              name: Electrometer B self-check
              type: DEPENDENT
              key: emeters-1.is_valid
              delay: '0'
              history: 365d
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.emeters[1].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
                  - tag: Application
                    value: Self-check
            - uuid: 95771bc1b4c046c7b1b8ac5124b95831
              name: Electrometer B power factor
              type: DEPENDENT
              key: emeters-1.pf
              delay: '0'
              history: 365d
              value_type: FLOAT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].pf'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: ff08c1312f8246ae91944f09660651ed
              name: Electrometer B power
              type: DEPENDENT
              key: emeters-1.power
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].power'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: 3781242b1f194fa087bc68bb5da65216
              name: Electrometer B total consumed
              type: DEPENDENT
              key: emeters-1.total
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].total'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: a3818f93484d491095218e9258acdc0b
              name: Electrometer B total returned
              type: DEPENDENT
              key: emeters-1.total_returned
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].total_returned'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: 731fe4075bfd4a84bc73a4976a4fbaf8
              name: Electrometer B voltage
              type: DEPENDENT
              key: emeters-1.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[1].voltage'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer B
                  - tag: Application
                    value: Electrometers
            - uuid: 792044981174459dbf4dbb379da75116
              name: Electrometer C current
              type: DEPENDENT
              key: emeters-2.current
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: A
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].current'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: 3f96377570304784bb87826838c0a930
              name: Electrometer C self-check
              type: DEPENDENT
              key: emeters-2.is_valid
              delay: '0'
              history: 365d
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.emeters[2].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
                  - tag: Application
                    value: Self-check
            - uuid: 0d5edf970edc424baf495409356feb10
              name: Electrometer C power factor
              type: DEPENDENT
              key: emeters-2.pf
              delay: '0'
              history: 365d
              value_type: FLOAT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].pf'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: c6d4a2a3ea1542bb94c51f3872733de4
              name: Electrometer C power
              type: DEPENDENT
              key: emeters-2.power
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].power'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: 3e0d929ef58148b9a4007f2440553c98
              name: Electrometer C total consumed
              type: DEPENDENT
              key: emeters-2.total
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].total'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: c3b5763ba8994105a514b04097cc0baa
              name: Electrometer C total returned
              type: DEPENDENT
              key: emeters-2.total_returned
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].total_returned'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: 419c8d58349d487b9da670945c608944
              name: Electrometer C voltage
              type: DEPENDENT
              key: emeters-2.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[2].voltage'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer C
                  - tag: Application
                    value: Electrometers
            - uuid: 84c0ab76969a4465966f77648615d560
              name: Electrometer N current
              type: DEPENDENT
              key: emeters-3.current
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              units: A
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].current'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: cdeeb06649064afa8238af003acff3da
              name: Electrometer N self-check
              type: DEPENDENT
              key: emeters-3.is_valid
              delay: '0'
              history: 365d
              status: DISABLED
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.emeters[3].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
                  - tag: Application
                    value: Self-check
            - uuid: 2eb2c8442c1b4c8f812edc0a8e509298
              name: Electrometer N power factor
              type: DEPENDENT
              key: emeters-3.pf
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].pf'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: 7f408becd77e4b6f817a4f93546aa583
              name: Electrometer N power
              type: DEPENDENT
              key: emeters-3.power
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].power'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: 788ba14c094b4b0bb3d281a68d501aee
              name: Electrometer N total consumed
              type: DEPENDENT
              key: emeters-3.total
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].total'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: 00a81e0ebf7d420fb6b385018d0fa1c2
              name: Electrometer N total returned
              type: DEPENDENT
              key: emeters-3.total_returned
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].total_returned'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: 8ef3032f89c441cfacdf07ba817447bb
              name: Electrometer N voltage
              type: DEPENDENT
              key: emeters-3.voltage
              delay: '0'
              history: 365d
              status: DISABLED
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.emeters[3].voltage'
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer N
                  - tag: Application
                    value: Electrometers
            - uuid: 4404c3bc5eff49189654f19c11ca72b5
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 7562c85165484dbbbcf5e6edbbf8c88f
              name: Sysflash is mounted
              type: DEPENDENT
              key: fs_mounted
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_mounted
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 5288f28eedd449abbc569756d4ce28e6
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 8c75d74cad834425a8da022e8d4b3557
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: c20c645c16444a68a445d563bdd50289
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: e4d23db2b1294bd59254f914e4d30d25
                  expression: >-
                    min(/Template Shelly
                    3EM/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN} and
                    min(/Template Shelly
                    3EM/icmppingloss[{$SHELLY_HOST}],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: 'max(/Template Shelly 3EM/icmpping[{$SHELLY_HOST}],#3)=0'
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: c1ab8da2ccef46a9bb351427bebcad4a
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 8ba3a5bb246a4700b9e09c04379e7c53
                  expression: >-
                    avg(/Template Shelly
                    3EM/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly
                          3EM/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly
                          3EM/icmppingloss[{$SHELLY_HOST}],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly
                          3EM/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 2a07b863e4dd432488ba2c51b1c004e6
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: ef9f5c0ec8254e7e800d0afbefdd6c24
                  expression: 'max(/Template Shelly 3EM/icmpping[{$SHELLY_HOST}],#3)=0'
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: d521187129a5411f8e9bc02f13f84c38
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: 685912c5b9a54f75b633d5420869332c
                  expression: change(/Template Shelly 3EM/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: c0847962493a40c58d4f6f656aa63067
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: 30cf2ff764614e4e9601ad71b6253f35
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: fe47ce26f64447faaf33fb3ebb08de25
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: ce873be92ef841a0addf0afc2247ecaf
              name: Relay has timer
              type: DEPENDENT
              key: relays-0.has_timer
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].has_timer'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 4c095f7d9a744099bb651a256ecdeb23
              name: Relay turned on
              type: DEPENDENT
              key: relays-0.ison
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].ison'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
              triggers:
                trigger:
                  uuid: d082a453be7f460e84a94345246fb092
                  expression: change(/Template Shelly 3EM/relays-0.ison)<>0
                  name: Relay state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: Relay
            - uuid: 20d8327462524510809a6499c92220f1
              name: Relay sensor self-check
              type: DEPENDENT
              key: relays-0.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.relays[0].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Relay
                  - tag: Application
                    value: Sefl-check
            - uuid: 06ea44d476f84a57af7ef4085643fb4d
              name: Relay overpower occurred
              type: DEPENDENT
              key: relays-0.overpower
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].overpower'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
              triggers:
                trigger:
                  uuid: 88c69464d8674e43a4bc999cc28ae637
                  expression: last(/Template Shelly 3EM/relays-0.overpower)="true"
                  name: Overpower event has been detected
                  priority: DISASTER
                  tags:
                    tag:
                      tag: Application
                      value: Relay
            - uuid: 24f315d570834754bf45d7efb4cae709
              name: Relays last command source
              type: DEPENDENT
              key: relays-0.source
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].source'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: c9af4f1c9de140628fb643a0df32952a
              name: Relay timer duration
              type: DEPENDENT
              key: relays-0.timer_duration
              delay: '0'
              history: 365d
              units: s
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_duration'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: b5dce777b94a4455a0e8af1bb22eb046
              name: Relay timer remaining
              type: DEPENDENT
              key: relays-0.timer_remaining
              delay: '0'
              history: 365d
              units: s
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_remaining'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 2ec1759dc1514bb2bd717f7aec6a9eb8
              name: Relay timer started
              type: DEPENDENT
              key: relays-0.timer_started
              delay: '0'
              history: 365d
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_started'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 3be4affc0ee64957aab6101f87f169b3
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: 4d77de91491f41ddbc33c38009f874cb
                  expression: 'nodata(/Template Shelly 3EM/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: 2ddd6bb4d43f4f8da1ae786c051e1324
              name: Total consumption from last reset
              type: DEPENDENT
              key: total_consuption
              delay: '0'
              history: 1825d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JAVASCRIPT
                  parameters:
                    parameter: |-
                      var json_data = JSON.parse(value);

                      var emeter_a = 0;
                      var emeter_b = 0;
                      var emeter_c = 0;
                      var emeter_n = 0;

                      if (json_data.emeters[0]) {
                        emeter_a = json_data.emeters[0].total;
                      }
                      if (json_data.emeters[1]) {
                        emeter_b = json_data.emeters[1].total;
                      }
                      if (json_data.emeters[2]) {
                        emeter_c = json_data.emeters[2].total;
                      }
                      if (json_data.emeters[3]) {
                        emeter_n = json_data.emeters[3].total;
                      }

                      return (emeter_a + emeter_b + emeter_c + emeter_n);
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Electrometer summary
            - uuid: 59326fc54a664511bb2a9fa8bf66f277
              name: Total power consumption
              type: DEPENDENT
              key: total_power
              delay: '0'
              history: 1825d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.total_power
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Electrometer summary
            - uuid: ca8c3df5619a45d6b39d9ec6dd54572b
              name: Total return from last reset
              type: DEPENDENT
              key: total_returned
              delay: '0'
              history: 1825d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JAVASCRIPT
                  parameters:
                    parameter: |-
                      var json_data = JSON.parse(value);

                      var emeter_a = 0;
                      var emeter_b = 0;
                      var emeter_c = 0;
                      var emeter_n = 0;

                      if (json_data.emeters[0]) {
                        emeter_a = json_data.emeters[0].total_returned;
                      }
                      if (json_data.emeters[1]) {
                        emeter_b = json_data.emeters[1].total_returned;
                      }
                      if (json_data.emeters[2]) {
                        emeter_c = json_data.emeters[2].total_returned;
                      }
                      if (json_data.emeters[3]) {
                        emeter_n = json_data.emeters[3].total_returned;
                      }

                      return (emeter_a + emeter_b + emeter_c + emeter_n);
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Electrometer summary
            - uuid: 3d2c95d37a31473dabad2f5c032e9646
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 1e044004af7641d1b0667e6673a7a254
                  expression: 'fuzzytime(/Template Shelly 3EM/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: cd607f9158814daa8a0524670cefee5d
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9acda239f1674008a4b8e1893c16d272
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: e93b9500a8264661bb2310ff79cbf549
                  expression: last(/Template Shelly 3EM/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 3d26a038683146e9b231972baa8db695
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9ac45f72d12e4d24975d88adb762654e
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 06d0ca8b4d114a14bb5ee89a08746684
                  expression: change(/Template Shelly 3EM/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 0814f99bc8844e16ae35439ab18f111f
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 2ef19e5b21c8478a9c1ea4f4ce4ff251
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: edabab5ffff1468eb059e1eb115a047b
                  expression: change(/Template Shelly 3EM/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 32436f883f22495ebd0e4ed4d6f1109d
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 34be1fb7cb374e2f88710ced1f39f6e9
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: b5f34de0544e476c95773265b16ea494
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 5d55d8ae37a84e1c939d798d0f43c543
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$EC_EM_CONSUMPTION}'
              value: '0'
              description: >-
                Total value on your electric company electrometer in Wh at the
                moment you reset Shelly 3EM data.
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 3744628ae85645edbfe818519ce35827
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: ffffe09da8bf44efae7cc9a7fecadfd9
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
      - uuid: 2304f9f6bd8741cfa2fcca834ea45fa5
        template: Template Shelly Bulb RGBW
        name: Template Shelly Bulb RGBW
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: 487e9726eba04925ae11cfe8b9e5c487
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 1491aa93fe5443c69249edc4dc2b57e7
                  expression: change(/Template Shelly Bulb RGBW/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 5044b2b7774a4b6bb277e86098592e86
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 2b5988ababab4fe0a435d8ebfd31387e
                  expression: change(/Template Shelly Bulb RGBW/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 2cd32647c9594da5b02da1a65b8ede2d
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: cced6d7775bf4ca48cc2b83587c592e2
                  expression: change(/Template Shelly Bulb RGBW/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 7e78233c83c2438d9add4c5de8d45032
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: aab2c35fb6a0492b81e8c3962cfddd99
                  expression: change(/Template Shelly Bulb RGBW/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 85f9ead1b0014840b97f477e9e537ba3
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: a82f48c4e0b14cc18bf29c32d1798bbd
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 0c25f1d9a33242d2a409cee2a2af2857
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              timeout: 25s
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: c916dfad59784ba4bf0a5bd4816bec42
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: b13469d7bace4e679d61b1e4e9545bea
                  expression: >-
                    min(/Template Shelly Bulb
                    RGBW/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN} and
                    min(/Template Shelly Bulb
                    RGBW/icmppingloss[{$SHELLY_HOST}],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: >-
                        max(/Template Shelly Bulb
                        RGBW/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 6ac81482c9974bbb9e71fd55c889b6dc
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: a2709203d6484818a55bfcf8449ef242
                  expression: >-
                    avg(/Template Shelly Bulb
                    RGBW/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly Bulb
                          RGBW/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly Bulb
                          RGBW/icmppingloss[{$SHELLY_HOST}],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly Bulb
                          RGBW/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: cc296052771b441f82426a8952e34570
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: ee88e27374dc451497f88b193c88b75b
                  expression: >-
                    max(/Template Shelly Bulb
                    RGBW/icmpping[{$SHELLY_HOST}],#3)=0
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: e839ce9f08b14df98cfeba29c695d884
              name: Light color channel blue
              type: DEPENDENT
              key: lights-0.blue
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].blue'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 663ad00ededa4f3897207ba911163e42
              name: Light white brightness
              type: DEPENDENT
              key: lights-0.brightness
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].brightness'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: e283bcc78f0e492984c8514425690645
              name: Light color
              type: DEPENDENT
              key: lights-0.color
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JAVASCRIPT
                  parameters:
                    parameter: |-
                      var json_data = JSON.parse(value);

                      var color = 'Unknown';

                      var mode = '?';
                      var red = '?';
                      var green = '?';
                      var blue = '?';
                      var gain = '?';
                      var temp = '?';
                      var brightness = '?';

                      if (json_data.lights[0].mode !== undefined) {
                        mode = json_data.lights[0].mode;
                      }
                      if (json_data.lights[0].red !== undefined) {
                        red = json_data.lights[0].red;
                      }
                      if (json_data.lights[0].green !== undefined) {
                        green = json_data.lights[0].green;
                      }
                      if (json_data.lights[0].blue !== undefined) {
                        blue = json_data.lights[0].blue;
                      }
                      if (json_data.lights[0].gain !== undefined) {
                        gain = json_data.lights[0].gain;
                      }
                      if (json_data.lights[0].temp !== undefined) {
                        temp = json_data.lights[0].temp;
                      }
                      if (json_data.lights[0].brightness !== undefined) {
                        brightness = json_data.lights[0].brightness;
                      }

                      if (mode == 'color') {
                        color = mode + ' - R: ' + red + ', G: ' + green + ', B: ' + blue + ', Gain: ' + gain;
                      } else if (mode == 'white') {
                        color = mode + ' - Temp: ' + temp + ', Bright: ' + brightness;
                      } else {
                        color = 'Unknown (' + mode + ') - R: ' + red + ', G: ' + green + ', B: ' + blue + ', Gain: ' + gain + ', Temp: ' + temp + ', Bright: ' + brightness;
                      }

                      return color ;
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
              triggers:
                trigger:
                  uuid: daa8998a931f414383cc6080d0584735
                  expression: change(/Template Shelly Bulb RGBW/lights-0.color)<>0
                  name: Light color changed
                  status: DISABLED
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: Light
            - uuid: f8bbb822ae2f430483077fc40b478da5
              name: Light color effect
              type: DEPENDENT
              key: lights-0.effect
              delay: '0'
              history: 1w
              valuemap:
                name: Light effects
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].effect'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 415ce11b71104f1188aee20bc79675ad
              name: Light color gain
              type: DEPENDENT
              key: lights-0.gain
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].gain'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: a224f626002045198b3d65a08dabb977
              name: Light color channel green
              type: DEPENDENT
              key: lights-0.green
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].green'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: f96c82230760490f84b56a8c6e1c82b4
              name: Light has timer
              type: DEPENDENT
              key: lights-0.has_timer
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].has_timer'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: e0d94daa32014322aeab76f2dfe8548f
              name: Light turned on
              type: DEPENDENT
              key: lights-0.ison
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].ison'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
              triggers:
                trigger:
                  uuid: 1f225eb60819496e9824e7b4da2d88f7
                  expression: change(/Template Shelly Bulb RGBW/lights-0.ison)<>0
                  name: Light state changed
                  status: DISABLED
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: Light
            - uuid: 7b52d220f12841658e7f23b4459ad5d7
              name: Light mode
              type: DEPENDENT
              key: lights-0.mode
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].mode'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 1b9b36635b2b45e698e202285b5a1756
              name: Light color channel red
              type: DEPENDENT
              key: lights-0.red
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].red'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 531d171b0d034a0cb61ce146140a0b4c
              name: Light white temperature
              type: DEPENDENT
              key: lights-0.temp
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].temp'
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 0dd3ed591af845b493dc4a5f6e68b2a5
              name: Light timer remaining
              type: DEPENDENT
              key: lights-0.timer_remaining
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].timer_remaining'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: f4e5f2b5c8bf49059533677a1ef0cf1b
              name: Light transition time
              type: DEPENDENT
              key: lights-0.transition
              delay: '0'
              history: 1w
              units: ms
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.lights[0].transition'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Light
            - uuid: 83f1857d1f024d199c29343831adb4c6
              name: Electrometer self-check
              type: DEPENDENT
              key: meters-0.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.meters[0].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Self-check
            - uuid: c037ab119aed44fdbd960ef85cc433a2
              name: Electrometer power
              type: DEPENDENT
              key: meters-0.power
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.meters[0].power'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Electrometer
            - uuid: 213db724f1f148ac9a9458a94d20c700
              name: Electrometer total consumed
              type: DEPENDENT
              key: meters-0.total
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wh
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.meters[0].total'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Electrometer
            - uuid: 56bec3f8889147338bb994f5ea79c4c7
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: f7345aedab2b4617b591435b56e74024
                  expression: change(/Template Shelly Bulb RGBW/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: e35691efa2a44b40ae9f4c67d030ea1f
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: e50bb554f4ac4c66be44b0e81c75eb9a
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 68d7380e957e407f90834af68d306157
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 83c2f76a70c64a06ade7c94c2e4b810b
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: bdd64b4c8d124c50b49823c501c43262
                  expression: 'nodata(/Template Shelly Bulb RGBW/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: e212dea903bc4c7dbccf9c5b341b0e02
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 34ae51bb773f46fe9e7e2fee611c831f
                  expression: 'fuzzytime(/Template Shelly Bulb RGBW/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 9bdeb607f22d4328a0fe442d798845e1
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 46eb8615485348ca99e39bc0a46f9a63
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: dfc0b4e32fe44d00ade256bd533f6e11
                  expression: last(/Template Shelly Bulb RGBW/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: c76a5e4c8581459c8dc2bc01c09105b2
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: e56ea45d5c534c02b9ee8698da29509b
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: c935efda6b6c4667b89942242cc5e473
                  expression: change(/Template Shelly Bulb RGBW/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 8e71c700a3ce48ffba32e8a674b3c109
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 0948db270a8646cbae47a4508ef41420
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 76b64ca0bdfc4df5ac779222129dd70f
                  expression: change(/Template Shelly Bulb RGBW/uptime)<0
                  name: Device has been restarted
                  status: DISABLED
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 70391e27ddba4993940a69eac68dc6fb
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: e1866c5349b84ec28905b46683cc01af
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 7f89d382a0a1460faeadd8634602a592
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 49dbe3c784404b368782dff4eb060aa6
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 3979e3dbc225402299b01107ba69181c
              name: Light effects
              mappings:
                mapping:
                  - value: '0'
                    newvalue: 'Off'
                  - value: '1'
                    newvalue: Meteor Shower
                  - value: '2'
                    newvalue: Gradual Change
                  - value: '3'
                    newvalue: Flash
            - uuid: 27b7715f12794ed1a0ea90ebf249d204
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: e10d286089ce48f5b8c179e39d8d4827
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
      - uuid: ffcb2ac1fcc0469c94c1abafbb69cb21
        template: Template Shelly Button1
        name: Template Shelly Button1
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: 3ba56fe92bb84334a4c24fe07c83b9cd
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: b9497852538e4872840a993abf655ac7
                  expression: change(/Template Shelly Button1/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 63c649271cd8452bb5558914e19cc438
              name: Battery percentage
              type: DEPENDENT
              key: bat.value
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: '%'
              valuemap:
                name: Battery
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
              triggers:
                trigger:
                  - uuid: f875e4bc896e4df0823eb424979eb4a7
                    expression: >-
                      last(/Template Shelly Button1/bat.value)<=10 and
                      last(/Template Shelly Button1/bat.value)<>-1
                    name: Device battery is low
                    priority: HIGH
                    tags:
                      tag:
                        tag: Application
                        value: System
                  - uuid: ebffce5c9d634774a746365957359b5c
                    expression: >-
                      last(/Template Shelly Button1/bat.value)>10 and
                      last(/Template Shelly Button1/bat.value)<=20
                    name: Device battery is low
                    priority: AVERAGE
                    tags:
                      tag:
                        tag: Application
                        value: System
            - uuid: 438035871cc741bd9f31737da4c5f311
              name: Battery voltage
              type: DEPENDENT
              key: bat.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.voltage
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
            - uuid: f340c8dca9bf4023a067ab68fe81baa3
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: efad659033d04436aa521e37aef25349
                  expression: change(/Template Shelly Button1/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 438e825d4f8e4d839b77551e7bdc29f4
              name: Charger connected
              type: DEPENDENT
              key: charger
              delay: '0'
              history: 365d
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.charger
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 2af36f82fe5247f8a9a141e9038b90d6
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 7414c4ae7af74bcb8ae7b275b5799cff
                  expression: change(/Template Shelly Button1/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: c56cc9b1ff5349f8957f0efb420c980b
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 903b344bcf1947a186608ee1d4e2a4cc
                  expression: change(/Template Shelly Button1/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: d46bc295406947c78a35a0981bfcff39
              name: WiFi connect retries
              type: DEPENDENT
              key: connect_retries
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.connect_retries
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 490a8998d2af481f9a56f44d872da711
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9231e3aeedea4833b8e174c645826ae3
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: db65692caea846a989d791ed9bd9fd56
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: 17f899e326164da7bbc82ed17f071894
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 3cdec25e05e74728aa2c11d584e9cac2
                  expression: >-
                    min(/Template Shelly
                    Button1/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                    and min(/Template Shelly
                    Button1/icmppingloss[{$SHELLY_HOST}],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: >-
                        max(/Template Shelly
                        Button1/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 55a1088d71bf4e3e8f7cf6f65412b66a
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 11bda56b494b4fb09fac4c8026c01c79
                  expression: >-
                    avg(/Template Shelly
                    Button1/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly
                          Button1/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly
                          Button1/icmppingloss[{$SHELLY_HOST}],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly
                          Button1/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 2310c2698dd741669998bd55cadc05ad
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: a0c56ff0062949d8b651b5f57a26b2d1
                  expression: 'max(/Template Shelly Button1/icmpping[{$SHELLY_HOST}],#3)=0'
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 9f2520a4348343efae05c80b76ad2b83
              name: Device self-check
              type: DEPENDENT
              key: is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: System
            - uuid: a567b08144974a8e90d5bf464376029b
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: fe96ef4ad1414567ac8d55ea66665478
                  expression: change(/Template Shelly Button1/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 689e2875c112483c83332881439bb1ca
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: 78309e5ca9b548d297d169b80f100953
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: aa55bdbccc4a40a88a28bb2d5064a089
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: f6864ea33fa047cca662c262be8d6746
              name: Sensor error
              type: DEPENDENT
              key: sensor_error
              delay: '0'
              history: 1w
              valuemap:
                name: Sensor error
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.sensor_error
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 084e6ee3b44e4dffb75213475010042d
                  expression: last(/Template Shelly Button1/sensor_error)<>-1
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly Button1/sensor_error)=-1
                  name: Device has errors
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: e97edbf69b0c46e79bf86f59713bbda9
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: 90b1bef6db1b4e1b87e634bd9fc2b9c3
                  expression: 'nodata(/Template Shelly Button1/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: 4d27adbf54444b61b23aec243c085029
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 48ef5be0549f4209980cefbdd2a6e7c6
                  expression: 'fuzzytime(/Template Shelly Button1/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 2b66d1ce436549e58efb2d405a7b73cd
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 1a16bd7a5ba94e8abd4a0bab2dad8c6b
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: ff3f9d0d25074a7bba882d651c64332f
                  expression: last(/Template Shelly Button1/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 95a90394b6a2483395d35b7850c78b58
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9fe1e99b183c495f892023236a6a4303
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 4d34e7067c6a4a299de7053683fef229
                  expression: change(/Template Shelly Button1/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 3135331698d64a62a478d79f8bcbbce5
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 74e1588100a3476b9ea1ad226ff33fbb
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: fcac99c6f3854eba8fb74925c59e9bc2
                  expression: change(/Template Shelly Button1/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 0e22c4f3bfa84985a46e104c09e011c8
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 98dca65134eb4534b740cc9da82a22bb
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 34a01f466e7645deafadfa4edbc511a9
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 6fcf177b53314d08b4a950bfaae0327e
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 7d69b9c99aa84bd68631db2d05cdea54
              name: Battery
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Battery
                  - type: LESS_OR_EQUAL
                    value: '-1'
                    newvalue: Power cable
            - uuid: c4398d6a13f04723b440057d5c693a86
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: d5413b61a2174fc58696a9f7bbaacbfa
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
            - uuid: 457ec2de623846cf9207663224e40d84
              name: Sensor error
              mappings:
                mapping:
                  - value: '-1'
                    newvalue: No error
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Error
      - uuid: c48d95cf612f481ca974a80b5a2e8185
        template: Template Shelly Flood
        name: Template Shelly Flood
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: 9131d65406da4c44a51a091efb51bef7
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: db76e776a3be4c549d7eabf7ca848f3b
                  expression: change(/Template Shelly Flood/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 48d3c3a76c1b4ad3b8d0ce4ae2000c6a
              name: Battery percentage
              type: DEPENDENT
              key: bat.value
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: '%'
              valuemap:
                name: Battery
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
              triggers:
                trigger:
                  - uuid: 7efa98f2b1de450e9d7133baf25a4f18
                    expression: >-
                      last(/Template Shelly Flood/bat.value)<=10 and
                      last(/Template Shelly Flood/bat.value)<>-1
                    name: Device battery is low
                    priority: HIGH
                    tags:
                      tag:
                        tag: Application
                        value: System
                  - uuid: a9ac229d98a84d62b3de8112483b069f
                    expression: >-
                      last(/Template Shelly Flood/bat.value)>10 and
                      last(/Template Shelly Flood/bat.value)<=20
                    name: Device battery is low
                    priority: AVERAGE
                    tags:
                      tag:
                        tag: Application
                        value: System
            - uuid: 6ddc8fe2b82e49ec9824c72b30d94dff
              name: Battery voltage
              type: DEPENDENT
              key: bat.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.voltage
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
            - uuid: e4df4a9d64074fd19f80054770d1964e
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 11ca1feee6d34198bee9479d131e41fe
                  expression: change(/Template Shelly Flood/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: cc213df9b4f14079910656b71492f3e9
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: b6668773e84e4e5581150b70c39602c7
                  expression: change(/Template Shelly Flood/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 4c9939ef4cd14c1cbffe368885e3b659
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 7adbf2ef0a17484a863033e5cc5abb2b
                  expression: change(/Template Shelly Flood/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 8d18711c8c084f708c8aea7bfaf08da6
              name: Flood sensor
              type: DEPENDENT
              key: flood
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.flood
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Flood
              triggers:
                trigger:
                  uuid: 30e03190cb344156845f3f67410bfdaf
                  expression: last(/Template Shelly Flood/flood)="true"
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly Flood/flood)="false"
                  name: Flood detected
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Flood
            - uuid: a61696f605494069a434beaee86a57de
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 4c8c92d2d5d34a0ab82170b806daf5ff
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9dce610f668c4f7586a9716bcb655e60
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: ebee2dba87a642fbb4a83cff70136c72
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: aa73f48c7505450e8638420c91d68d18
                  expression: >-
                    min(/Template Shelly
                    Flood/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN} and
                    min(/Template Shelly
                    Flood/icmppingloss[{$SHELLY_HOST}],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: >-
                        max(/Template Shelly
                        Flood/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 301b6efa313443b291e6ac96c8e9ddfe
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 3799544d2dd443eaa58326ab4af30dee
                  expression: >-
                    avg(/Template Shelly
                    Flood/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly
                          Flood/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly
                          Flood/icmppingloss[{$SHELLY_HOST}],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly
                          Flood/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 7d837a8a223e49b49281713090988454
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              status: DISABLED
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 46301879ba0b4ee6b8fb4f8ef82dc495
                  expression: 'max(/Template Shelly Flood/icmpping[{$SHELLY_HOST}],#3)=0'
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 37514c00cf5d4a838a5311be19b8357c
              name: Device self-check
              type: DEPENDENT
              key: is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: System
            - uuid: 1669ac59f19d467d9c791e671c660277
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: 5c109d05de40482893d4166a213b7e86
                  expression: change(/Template Shelly Flood/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 847009984adb438f8e7119c32301f753
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: 1c705a74b90847a8a2ec5ec551870ba4
              name: Rain sensor
              type: DEPENDENT
              key: rain_sensor
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.rain_sensor
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Rain
              triggers:
                trigger:
                  uuid: 27285d7298be4ab295722b60727f1ab2
                  expression: last(/Template Shelly Flood/rain_sensor)="true"
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly Flood/rain_sensor)="false"
                  name: Rain detected
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Rain
            - uuid: c5e24ca4289e4fbf82c6a5b4891da834
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 2df6dca3f9a747bdbe4191fc341d1d8d
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9f1abad8f429457b9f3eb6ad356cd61b
              name: Sensor error
              type: DEPENDENT
              key: sensor_error
              delay: '0'
              history: 1w
              valuemap:
                name: Sensor error
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.sensor_error
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: e2a581dc4ba44f41b3de83ab7a8fd119
                  expression: last(/Template Shelly Flood/sensor_error)<>-1
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly Flood/sensor_error)=-1
                  name: Device has errors
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 51a5ea2b8e9a48b087a11e2c39e7ee23
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: ab265211fdf84b1dae5978529e94a207
                  expression: 'nodata(/Template Shelly Flood/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: 3e45f93977cf48edb7008dc3441f408d
              name: Temperature self-check
              type: DEPENDENT
              key: tmp.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.tmp.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: Temperature
            - uuid: f14e95cc18594be28c80f4c418071829
              name: Temperature in Celsius
              type: DEPENDENT
              key: tmp.tC
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °C
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tC
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: 54260a4eb2004ea8ae39446e35f979f5
              name: Temperature in Fahrenheit
              type: DEPENDENT
              key: tmp.tF
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °F
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tF
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: 0afbd51c39f04474abe2dec851715ea0
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: f9ee7bfbb6ca4d9aa3f6126d9330fd8a
                  expression: 'fuzzytime(/Template Shelly Flood/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 507bf7298b4f4a669a6aeefebfee9420
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: efb1799826e644aa8f3762a3af77c25b
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 555e8f4474234582a33537270e27caa6
                  expression: last(/Template Shelly Flood/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: cbc8df5efa0a41f39e6ca1022c6e45a9
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: f55d2a5781914ede8fe7f51a4dc8c26b
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 346d535d13c7440abcab7a6d6575714d
                  expression: change(/Template Shelly Flood/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 2767f1e0cec748d69e7fc60abc181fae
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: dfe0c19e86164b89b782f7a36c2d0915
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 0d5a2ac742884f69a5bfa362dae8a1d9
                  expression: change(/Template Shelly Flood/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 4b4fd6b2361f423eba6278ff8ef902ce
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 798ef99a7e1d4258b4b578d8eb17f1a3
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: e3f7b3debca445af952a571fb3253c68
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 492fd9dac99a476ab1273f7f7c321434
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: f53f8b9b9bae44f8bed42733202ac971
              name: Battery
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Battery
                  - type: LESS_OR_EQUAL
                    value: '-1'
                    newvalue: Power cable
            - uuid: c586700fc9db4a42ac08af3abfba1001
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: dc6815fff1c24457ad30965c4ebcd142
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
            - uuid: 0cd3c577375f49d99205c027457c2ff3
              name: Sensor error
              mappings:
                mapping:
                  - value: '-1'
                    newvalue: No error
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Error
      - uuid: 4d433c4a26c14a8bbb6651a041f2edb5
        template: Template Shelly HT
        name: Template Shelly HT
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: 6677fff62b48467387f19f193ffc9160
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 1ceb6a2b2df44a43af833707a4d67ee1
                  expression: change(/Template Shelly HT/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: b65c24b056274297bfc055bd70c280a9
              name: Battery percentage
              type: DEPENDENT
              key: bat.value
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: '%'
              valuemap:
                name: Battery
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
              triggers:
                trigger:
                  - uuid: 695d2997ae564fa081a32cbe5dbd993a
                    expression: >-
                      last(/Template Shelly HT/bat.value)<=10 and last(/Template
                      Shelly HT/bat.value)<>-1
                    name: Device battery is low
                    priority: HIGH
                    tags:
                      tag:
                        tag: Application
                        value: System
                  - uuid: ae43fcd114a047bc98d8458c26ead669
                    expression: >-
                      last(/Template Shelly HT/bat.value)>10 and last(/Template
                      Shelly HT/bat.value)<=20
                    name: Device battery is low
                    priority: AVERAGE
                    tags:
                      tag:
                        tag: Application
                        value: System
            - uuid: a6a2402c8ccf4d2097252110ce83d884
              name: Battery voltage
              type: DEPENDENT
              key: bat.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.voltage
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
            - uuid: 94d348bb94e3460a8da585260f1b2724
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: bc2fcbf85b934224a68ff5eae8f85703
                  expression: change(/Template Shelly HT/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: b8fb9bd837fe4233bdb4d4a2ea14b6b6
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 29ff6420b95f4260b96b2be357b203fd
                  expression: change(/Template Shelly HT/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 17811b04b891486cbc0a725e01cff68a
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 0deb89523e7045baae64d8b43e22cdc1
                  expression: change(/Template Shelly HT/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: a210364f925141b68bd376bea9afc212
              name: WiFi connect retries
              type: DEPENDENT
              key: connect_retries
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.connect_retries
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 22af458927df43888f7408812df87474
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: f1b5a9882bd64bb99201d6e327131c16
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 3c2ea61904fe43f589ac36655960dac6
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: e52e3f7438ae4b509bf32638838c558c
              name: Humidity self-check
              type: DEPENDENT
              key: hum.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.hum.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Humidity
                  - tag: Application
                    value: Self-check
            - uuid: 5fbfd8646bf647fa828b9ebd03f37971
              name: Humidity percentage
              type: DEPENDENT
              key: hum.value
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: '%'
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.hum.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Humidity
            - uuid: 67890100672942aebb1ad02069fac76f
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST},3,5000,68,5000]'
              history: 1w
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 0cdf7c2e7c924f39b5ce9ba9e5dbfb6d
                  expression: >-
                    min(/Template Shelly
                    HT/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)>{$ICMP_LOSS_WARN}
                    and min(/Template Shelly
                    HT/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: 'max(/Template Shelly HT/icmpping[{$SHELLY_HOST}],#3)=0'
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: bb3bc9c4fb2d4ec9b68e83036b1646b8
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 5b1a756a5e8c4dfeb735b9c8ec3738c2
                  expression: >-
                    avg(/Template Shelly
                    HT/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly
                          HT/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly
                          HT/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: 'max(/Template Shelly HT/icmpping[{$SHELLY_HOST}],#3)=0'
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 76b8bb9245b545518089d961de52c668
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: bb94cce18346485a84ea95dc4576676d
                  expression: 'max(/Template Shelly HT/icmpping[{$SHELLY_HOST}],#3)=0'
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 786ff44cf47140d7877632246eec80ff
              name: Device self-check
              type: DEPENDENT
              key: is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: System
            - uuid: 2283731198974006bc0e6cfbdc270f87
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: cf15d013c90e4c989266abd37a3e0620
                  expression: change(/Template Shelly HT/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: e5f27f38a98d4fc5a7c3956fad0c93bd
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: 8c29e129b8a2498c9003cb01690e440c
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 3ab6ab9f8a8d470e96152ff86acd6759
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 0a3cc77a730a4c6aa44046e9490b3a8f
              name: Sensor error
              type: DEPENDENT
              key: sensor_error
              delay: '0'
              history: 1w
              valuemap:
                name: Sensor error
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.sensor_error
                  error_handler: DISCARD_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: caac79ac6fe24b33829220497a8a88ae
                  expression: last(/Template Shelly HT/sensor_error)<>-1
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly HT/sensor_error)=-1
                  name: Device has errors
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 8667401b7dc7431eadbade6181d0d7e3
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: 6bc02fa15b0e467281e7c43d2cc8e2f5
                  expression: 'nodata(/Template Shelly HT/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: 717fa9bfe68b42c9aeae28f675a3db24
              name: Temperature self-check
              type: DEPENDENT
              key: tmp.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.tmp.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: Temperature
            - uuid: 23eef644f7774f9684296a7f51f5204c
              name: Temperature in Celsius
              type: DEPENDENT
              key: tmp.tC
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °C
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tC
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: 99a3185af0fb454f821e943847a23433
              name: Temperature in Fahrenheit
              type: DEPENDENT
              key: tmp.tF
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °F
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tF
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: 59d9e8005a544a8890ace2cfc983e7cf
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 4912d6f4314c49e1b440d83be543c917
                  expression: 'fuzzytime(/Template Shelly HT/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 665d8941569c47a2803ab81b7e187581
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: db38a132a10e4223909fefeaf943cc7b
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 15bd8ab9230443aa8304ab41e73eefea
                  expression: last(/Template Shelly HT/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: cd2a7d8dfcb8477c8736161c922cbe9d
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: a5516be760924a0bb1d274760345a043
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 0b4643b2fa664c1aa831bc2b6bf9f521
                  expression: change(/Template Shelly HT/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 066a84325a8c478e9bdc922f92c357d3
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 7c8710539d5947b28744f3a2b76b2976
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 093a6e0f511d486dbd8066e4d8e2b607
                  expression: change(/Template Shelly HT/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: da001b2e1d0347548bb2f91b5461f35b
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: dc5479db7b5b47fcb5cb3a165eb36719
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 364ec514e82f4d00b54547171f4e094c
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 7b9a7be85b9a48a984963eda0e849f0a
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 53111755d9624e279bcc0e0ef1af4d47
              name: Battery
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Battery
                  - type: LESS_OR_EQUAL
                    value: '-1'
                    newvalue: Power cable
            - uuid: 403d042bf04643c5b63ea3cec39b91de
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: 5f084fb7b91f4305ab43fcbe80391434
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
            - uuid: 855350c1e06946c9810800c0183ec078
              name: Sensor error
              mappings:
                mapping:
                  - value: '-1'
                    newvalue: No error
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Error
      - uuid: e5e4158ec3584ce6ade9e13c6b09bc56
        template: Template Shelly Motion
        name: Template Shelly Motion
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: b182a3f49dfa4a868d2aa11f2cbab8ee
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 8787a6f12e494a369b126d06fa4b6a9e
                  expression: change(/Template Shelly Motion/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 6371b845439a4c66a6a6a6f3627b252c
              name: Battery percentage
              type: DEPENDENT
              key: bat.value
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: '%'
              valuemap:
                name: Battery
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
              triggers:
                trigger:
                  - uuid: c6fdad66212e4e2d82c6574b8c0617fd
                    expression: >-
                      last(/Template Shelly Motion/bat.value)<=10 and
                      last(/Template Shelly Motion/bat.value)<>-1
                    name: Device battery is low
                    priority: HIGH
                    tags:
                      tag:
                        tag: Application
                        value: System
                  - uuid: 876689f576c34b2499754656e4e5b6ad
                    expression: >-
                      last(/Template Shelly Motion/bat.value)>10 and
                      last(/Template Shelly Motion/bat.value)<=20
                    name: Device battery is low
                    priority: AVERAGE
                    tags:
                      tag:
                        tag: Application
                        value: System
            - uuid: 87918a13ce8f4e43b9f09b58905a16a1
              name: Battery voltage
              type: DEPENDENT
              key: bat.voltage
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: V
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.bat.voltage
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Battery
            - uuid: 16e24d3bea4643909289f2729dbbd078
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 4060facac10547d59fd25f57a1ac0761
                  expression: change(/Template Shelly Motion/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 1796b216f22540a498bbcdd2f289b3b5
              name: Charger connected
              type: DEPENDENT
              key: charger
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.charger
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: c14500236c4848f3ae829ccdbd93483c
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: da45482d40b44e5b8e761053bce07c48
                  expression: change(/Template Shelly Motion/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: b2b35071152b48d5b1ea2e41fc26ab6d
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 9dfb447d1211449c939be9258d8e8e0c
                  expression: change(/Template Shelly Motion/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 33d5ca368f844f23a0f6c1c3b6357cb9
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: abce78709c4e4287adef784f8ce6bc28
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 629c64f8242c445ab53b002f7e7b3164
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              timeout: 25s
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: e5db03fc346e4692a175b47ba303a0c7
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST},3,5000,68,5000]'
              history: 1w
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 710d33ed46a64de5ad57c3fd20f0a78d
                  expression: >-
                    min(/Template Shelly
                    Motion/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)>{$ICMP_LOSS_WARN}
                    and min(/Template Shelly
                    Motion/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: >-
                        max(/Template Shelly
                        Motion/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 230f1f048e7e4f3b9c146f928dfa53b7
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: d552039e31184336bbeda84b35a6a7f1
                  expression: >-
                    avg(/Template Shelly
                    Motion/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly
                          Motion/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly
                          Motion/icmppingloss[{$SHELLY_HOST},3,5000,68,5000],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly
                          Motion/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: fca8511bbeb7488aae8959c16d2ca024
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 9ed8902d28a341de87f55da800b870e8
                  expression: 'max(/Template Shelly Motion/icmpping[{$SHELLY_HOST}],#3)=0'
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: bf34b11182194363b1eb807f82db2dd6
              name: Lux illumination
              type: DEPENDENT
              key: lux.illumination
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.lux.illumination
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Lux sensor
            - uuid: 17e40ac5118a4077b0fcf833809d8ede
              name: Lux sensor self-check
              type: DEPENDENT
              key: lux.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.lux.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Lux sensor
                  - tag: Application
                    value: Sefl-check
            - uuid: 315b506e11dc43f683c9ed9892d68b79
              name: Lux value
              type: DEPENDENT
              key: lux.value
              delay: '0'
              history: 365d
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.lux.value
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Lux sensor
            - uuid: fcc21fff6f7048f89d364c671e3b115a
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: 3fbd3df9794a4a69a706512332ffd59e
                  expression: change(/Template Shelly Motion/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: d8fb57bab47842539ef028c2b112179f
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: b673f5d7502240248b7b6bd3b3a68aa7
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: eb3a1f3530274fe98d9ffab706586030
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 25974414e1cc4701b7f7eaa871dfee63
              name: Motion sensor active
              type: DEPENDENT
              key: sensor.active
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.sensor.active
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Motion sensor
              triggers:
                trigger:
                  uuid: 46e649c53c6c437cac6948f1bd4c2cc3
                  expression: last(/Template Shelly Motion/sensor.active)="true"
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: last(/Template Shelly Motion/sensor.active)="false"
                  name: Motion sensor active
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: Motion sensor
            - uuid: 1467e5abcc38479fa71bbba68f1e6ab5
              name: Motion sensor self-check
              type: DEPENDENT
              key: sensor.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.sensor.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Motion sensor
                  - tag: Application
                    value: Sefl-check
            - uuid: 430cd77e6ea444c28924b3021892febd
              name: Motion detection
              type: DEPENDENT
              key: sensor.motion
              delay: '0'
              history: 365d
              valuemap:
                name: Motion
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.sensor.motion
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Motion sensor
            - uuid: 60d5d6b7d1db4ba693bbabdbe51e4630
              name: Tamper detection
              type: DEPENDENT
              key: sensor.vibration
              delay: '0'
              history: 365d
              valuemap:
                name: Tampering
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.sensor.vibration
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Motion sensor
            - uuid: bd2bba45efa3406d9e701650ff556bba
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: 38117ec9b9114443a56f727b60eb3367
                  expression: 'nodata(/Template Shelly Motion/status,180s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: a2b80942c39a487a8a057cd53f3cd758
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 875e7f149e6347aeb139445aa2489a5f
                  expression: 'fuzzytime(/Template Shelly Motion/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 3317b8b079814b5f946eb63fa6680207
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: d873de862fce4312ae0d51e3cea6b171
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: d405b2003e7d4ce78ee4c3cefce81eb9
                  expression: last(/Template Shelly Motion/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 51a1c1999ddc416bae5b16c59c69f114
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9f2f7fb1bb81424a845229f71e60e1ee
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 9050639bec0d442d9a6face8c5f3df67
                  expression: change(/Template Shelly Motion/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: ff5bc4a32a7441319d7f004ef4d26baa
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 142a08d145df4da4a30af028f381bb32
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 0bd330b80ba14509980f52c531e797b2
                  expression: change(/Template Shelly Motion/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: ad4d358c47874fb5962081a73aac42fd
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: a503e8f140ed4c729c3fe4c8556404fc
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: c53b5e9a29bd448c9848ec96a6a26b32
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 40ba849a48614489b0778687e5215991
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 312692980bb1432b84ce5f64dcaaad39
              name: Battery
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '0'
                    newvalue: Battery
                  - type: LESS_OR_EQUAL
                    value: '-1'
                    newvalue: Power cable
            - uuid: 319fdcbc35404cb9ad5f014459403036
              name: Motion
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Motion
                  - value: '0'
                    newvalue: No motion
            - uuid: b034c6ad33e24658896cf0768693774c
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: 9369a5ce4f394f2f8a2c2a21d030920c
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
            - uuid: 5f43c56d6fde454dbdaf9f8672d1ded8
              name: Tampering
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Tamper
                  - value: '0'
                    newvalue: No tamper
      - uuid: 42740ba2769246749725e554c85c1ce4
        template: Template Shelly Plug and Plug-S
        name: Template Shelly Plug and Plug-S
        groups:
          group:
            - name: Shelly
            - name: Templates/Network devices
        items:
          item:
            - uuid: 91a3a9b4d6e042d9974f3f6da8533111
              name: Skipped actions
              type: DEPENDENT
              key: actions_stats.skipped
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.actions_stats.skipped
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: ef2ec6de85e04718a580de0137ccde0a
                  expression: >-
                    change(/Template Shelly Plug and
                    Plug-S/actions_stats.skipped)>0
                  name: At least one action has been skipped
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 86798a7581e94a3da5de969dfe714c91
              name: System configuration changes
              type: DEPENDENT
              key: cfg_changed_cnt
              delay: '0'
              history: 1w
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cfg_changed_cnt
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 1dea1922d7f34cc891bac891702500ab
                  expression: change(/Template Shelly Plug and Plug-S/cfg_changed_cnt)>0
                  name: System configuration has been changed
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: d7d700f5cc23428aa78cba0fb4d5de63
              name: Cloud connected
              type: DEPENDENT
              key: cloud.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 08df627ef0e14dc281a06099f561f9b8
                  expression: change(/Template Shelly Plug and Plug-S/cloud.connected)<>0
                  name: Cloud connection state has changed
                  priority: AVERAGE
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 85163193a7484dfb90b6ff8b1cc0a038
              name: Cloud enabled
              type: DEPENDENT
              key: cloud.enabled
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.cloud.enabled
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Cloud
                  - tag: Application
                    value: System
              triggers:
                trigger:
                  uuid: 91ae9e1dceeb432e825d458b1ff23625
                  expression: change(/Template Shelly Plug and Plug-S/cloud.enabled)<>0
                  name: Cloud configuration has changed
                  priority: INFO
                  tags:
                    tag:
                      - tag: Application
                        value: Cloud
                      - tag: Application
                        value: System
            - uuid: 70255db192b7468784ef943006118bca
              name: File system free size
              type: DEPENDENT
              key: fs_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 70b2b8f077ba4d22884f12f6a481ab59
              name: File system total size
              type: DEPENDENT
              key: fs_size
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.fs_size
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: bee23426b54245b1a19ad658b67d8b6c
              name: Data collector - HTTP
              type: HTTP_AGENT
              key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              delay: '30'
              history: 1h
              trends: '0'
              value_type: TEXT
              authtype: BASIC
              username: '{$SHELLY_USER}'
              password: '{$SHELLY_PASS}'
              description: Collect data from Shelly device status API.
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.body
              url: 'http://{$SHELLY_HOST}/status'
              follow_redirects: 'NO'
              output_format: JSON
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: bee12ddb11a44d0eb841b86a2ab1e5e6
              name: ICMP loss
              type: SIMPLE
              key: 'icmppingloss[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: '%'
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: b3187e399f344b5d80efb164ae722e50
                  expression: >-
                    min(/Template Shelly Plug and
                    Plug-S/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                    and min(/Template Shelly Plug and
                    Plug-S/icmppingloss[{$SHELLY_HOST}],5m)<100
                  name: High ICMP ping loss
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      name: Unavailable by ICMP ping
                      expression: >-
                        max(/Template Shelly Plug and
                        Plug-S/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 108a4b06b36d4b9f850e2dabf9232647
              name: ICMP response time
              type: SIMPLE
              key: 'icmppingsec[{$SHELLY_HOST}]'
              history: 1w
              value_type: FLOAT
              units: s
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: f7daf429f2d544fcbc3d0c740a5b2fae
                  expression: >-
                    avg(/Template Shelly Plug and
                    Plug-S/icmppingsec[{$SHELLY_HOST}],5m)>{$ICMP_RESPONSE_TIME_WARN}
                  name: High ICMP ping response time
                  priority: WARNING
                  description: 'Last value: {ITEM.LASTVALUE1}.'
                  dependencies:
                    dependency:
                      - name: High ICMP ping loss
                        expression: >-
                          min(/Template Shelly Plug and
                          Plug-S/icmppingloss[{$SHELLY_HOST}],5m)>{$ICMP_LOSS_WARN}
                          and min(/Template Shelly Plug and
                          Plug-S/icmppingloss[{$SHELLY_HOST}],5m)<100
                      - name: Unavailable by ICMP ping
                        expression: >-
                          max(/Template Shelly Plug and
                          Plug-S/icmpping[{$SHELLY_HOST}],#3)=0
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 8044d68769c14f0c8e58b4946871117f
              name: ICMP ping
              type: SIMPLE
              key: 'icmpping[{$SHELLY_HOST}]'
              history: 1w
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 949255cfb929445b993608dc01e9a201
                  expression: >-
                    max(/Template Shelly Plug and
                    Plug-S/icmpping[{$SHELLY_HOST}],#3)=0
                  name: Unavailable by ICMP ping
                  priority: HIGH
                  description: >-
                    Last value: {ITEM.LASTVALUE1}.

                    Last three attempts returned timeout.  Please check device
                    connectivity.
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 5b8afd21a3684254a62a9b12bf412986
              name: Electrometer self-check
              type: DEPENDENT
              key: meters-0.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: '$.meters[0].is_valid'
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Electrometer
                  - tag: Application
                    value: Self-check
            - uuid: 48b0d608a6304457900ad74be46115c6
              name: Electrometer overpower occurred
              type: DEPENDENT
              key: meters-0.overpower
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.meters[0].overpower'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Electrometer
              triggers:
                trigger:
                  uuid: 8bcfea1aa8ee409e992159eb460111bc
                  expression: >-
                    last(/Template Shelly Plug and
                    Plug-S/meters-0.overpower)="true"
                  name: Overpower event has been detected
                  priority: DISASTER
                  tags:
                    tag:
                      tag: Application
                      value: Relay
            - uuid: 8a6f5a3389bb4a34a64852dcaea9bc4c
              name: Electrometer power
              type: DEPENDENT
              key: meters-0.power
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: W
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.meters[0].power'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Electrometer
            - uuid: 927bd642a38a4aca92f013539befec6d
              name: Electrometer total consumed
              type: DEPENDENT
              key: meters-0.total
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: Wm
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.meters[0].total'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Electrometer
            - uuid: 1fd6f125271642acb5dd4aa4cc938f47
              name: MQTT connected
              type: DEPENDENT
              key: mqtt.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.mqtt.connected
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: MQTT
              triggers:
                trigger:
                  uuid: bde85e437d734a91ad6066451590d451
                  expression: change(/Template Shelly Plug and Plug-S/mqtt.connected)<>0
                  name: MQTT connection state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 888ca31432bd4a23853db55daa73ed4c
              name: Data collector - MQTT
              type: ZABBIX_ACTIVE
              key: >-
                mqtt.get[{$MQTT_BROKER_HOST},shellies/{$MQTT_DEVICE_ID}/info,{$MQTT_BROKER_USER},{$MQTT_BROKER_PASS}]
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from Shelly device status topic.
              tags:
                tag:
                  tag: Application
                  value: Data collection
            - uuid: cd8d3212af3840c7913fa1a3b6ce1d0d
              name: Device overtemperature occurred
              type: DEPENDENT
              key: overtemperature
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.overtemperature
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
              triggers:
                trigger:
                  uuid: 5fbc7758a5244056af7c583eb646f4e4
                  expression: >-
                    last(/Template Shelly Plug and
                    Plug-S/overtemperature)="true"
                  name: Overtemperature event has been detected
                  priority: DISASTER
                  tags:
                    tag:
                      tag: Application
                      value: Temperature
            - uuid: c9e1f361ece24579b7104d8279813bdc
              name: RAM free
              type: DEPENDENT
              key: ram_free
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_free
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: fe87dfe1292749278da40e85afe49354
              name: RAM total
              type: DEPENDENT
              key: ram_total
              delay: '0'
              history: 1w
              units: B
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.ram_total
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 648a71b874f948c28391fad1b9b64416
              name: Relay has timer
              type: DEPENDENT
              key: relays-0.has_timer
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].has_timer'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 786f236af2b84d0f943121b407586854
              name: Relay turned on
              type: DEPENDENT
              key: relays-0.ison
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].ison'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
              triggers:
                trigger:
                  uuid: 346502b7bec243288ed9c88c04879cbc
                  expression: change(/Template Shelly Plug and Plug-S/relays-0.ison)<>0
                  name: Relay state has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: Relay
            - uuid: ee5a0c03b9aa4679befaa0540d9b9bc9
              name: Relay overpower occurred
              type: DEPENDENT
              key: relays-0.overpower
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].overpower'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
              triggers:
                trigger:
                  uuid: d35da485f66644a3bf8edfacaa45c76b
                  expression: >-
                    last(/Template Shelly Plug and
                    Plug-S/relays-0.overpower)="true"
                  name: Overpower event has been detected
                  priority: DISASTER
                  tags:
                    tag:
                      tag: Application
                      value: Relay
            - uuid: 76c73cc4c4db43dd902804bdb4ca1a8e
              name: Relays last command source
              type: DEPENDENT
              key: relays-0.source
              delay: '0'
              history: 365d
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].source'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: b2d9605591e545fdb129785e2514a381
              name: Relay timer duration
              type: DEPENDENT
              key: relays-0.timer_duration
              delay: '0'
              history: 365d
              units: s
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_duration'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 11363348cce14f26b3df57f983f89fa3
              name: Relay timer remaining
              type: DEPENDENT
              key: relays-0.timer_remaining
              delay: '0'
              history: 365d
              units: s
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_remaining'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 988dc400cb2b449cbff9b5df6c29f80d
              name: Relay timer started
              type: DEPENDENT
              key: relays-0.timer_started
              delay: '0'
              history: 365d
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: '$.relays[0].timer_started'
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Relay
            - uuid: 58112dbd3fd34770b1c924163d94192c
              name: Status data
              type: DEPENDENT
              key: status
              delay: '0'
              history: 1h
              trends: '0'
              value_type: TEXT
              description: Collect data from HTTP or MQTT data collector items.
              master_item:
                key: 'http.get[{$SHELLY_HOST},{$SHELLY_USER},{$SHELLY_PASS}]'
              tags:
                tag:
                  tag: Application
                  value: Data collection
              triggers:
                trigger:
                  uuid: 0f12dac3e7ab450d93a2162a3d4dcbad
                  expression: 'nodata(/Template Shelly Plug and Plug-S/status,120s)=1'
                  name: No data received
                  priority: HIGH
                  tags:
                    tag:
                      tag: Application
                      value: Data collection
            - uuid: 6e62338a33f44024a19caaf980332d06
              name: Temperature self-check
              type: DEPENDENT
              key: tmp.is_valid
              delay: '0'
              history: 365d
              valuemap:
                name: Self-check
              preprocessing:
                step:
                  - type: JSONPATH
                    parameters:
                      parameter: $.tmp.is_valid
                  - type: BOOL_TO_DECIMAL
                    parameters:
                      parameter: ''
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: Self-check
                  - tag: Application
                    value: Temperature
            - uuid: 51bf83593a26418d95ae113d80b6352d
              name: Temperature in Celsius
              type: DEPENDENT
              key: tmp.tC
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °C
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tC
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: f5c54d9efa124b90b8a669d7f4e74cd9
              name: Temperature in Fahrenheit
              type: DEPENDENT
              key: tmp.tF
              delay: '0'
              history: 365d
              value_type: FLOAT
              units: °F
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.tmp.tF
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: Temperature
            - uuid: f384c05104a04255b1c45eae4d4ccefd
              name: Device time
              type: DEPENDENT
              key: unixtime
              delay: '0'
              history: 1w
              units: unixtime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.unixtime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 3d82b0ea7ca94ab9bc315499b6664cae
                  expression: 'fuzzytime(/Template Shelly Plug and Plug-S/unixtime,60s)=0'
                  name: Time is out of sync
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: beebf413a9dd4d64be36133a1f95c734
              name: Firmware beta version
              type: DEPENDENT
              key: update.beta_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.beta_version
                  error_handler: CUSTOM_VALUE
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 49596ea9fdf14dd0995948b53cf22066
              name: Update available
              type: DEPENDENT
              key: update.has_update
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.has_update
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: d538eeb87492428cb6347c4d5fa3482f
                  expression: >-
                    last(/Template Shelly Plug and
                    Plug-S/update.has_update)="true"
                  name: Update available
                  priority: INFO
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 5e8b1885642c45ba9a03d1f8a23efb32
              name: Firmware new version
              type: DEPENDENT
              key: update.new_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.new_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 9764737b1140495c96042c8d4b5a5a7f
              name: Firmware old version
              type: DEPENDENT
              key: update.old_version
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.old_version
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 7ddaa3818c234968a25381497fc8e71c
                  expression: >-
                    change(/Template Shelly Plug and
                    Plug-S/update.old_version)<>0
                  name: Version has changed
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 81744d620ce54b3d8063da59a5e6974d
              name: Update status
              type: DEPENDENT
              key: update.status
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.update.status
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
            - uuid: 22423744cd0d40f694acfde3fe9c98c2
              name: Uptime
              type: DEPENDENT
              key: uptime
              delay: '0'
              history: 1w
              units: uptime
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.uptime
              master_item:
                key: status
              tags:
                tag:
                  tag: Application
                  value: System
              triggers:
                trigger:
                  uuid: 38438df02abe47ca8ca10675624b615a
                  expression: change(/Template Shelly Plug and Plug-S/uptime)<0
                  name: Device has been restarted
                  priority: WARNING
                  tags:
                    tag:
                      tag: Application
                      value: System
            - uuid: 7fec7a57b4a54af3a4f87c53fe5bee06
              name: WiFi connected
              type: DEPENDENT
              key: wifi_sta.connected
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.connected
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 06850685459e43a899c163c7b6dcb553
              name: WiFi IP
              type: DEPENDENT
              key: wifi_sta.ip
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ip
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 8ae762bd211a444fb8c12ed786bf6ae6
              name: WiFi RSSI
              type: DEPENDENT
              key: wifi_sta.rssi
              delay: '0'
              history: 1w
              value_type: FLOAT
              units: dBm
              valuemap:
                name: Received Signal Strength Indicator
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.rssi
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
            - uuid: 8103f845df5d40479c0dd3f933fa61cf
              name: WiFi SSID
              type: DEPENDENT
              key: wifi_sta.ssid
              delay: '0'
              history: 1w
              trends: '0'
              value_type: TEXT
              preprocessing:
                step:
                  type: JSONPATH
                  parameters:
                    parameter: $.wifi_sta.ssid
              master_item:
                key: status
              tags:
                tag:
                  - tag: Application
                    value: System
                  - tag: Application
                    value: WiFi
        macros:
          macro:
            - macro: '{$ICMP_LOSS_WARN}'
              value: '20'
            - macro: '{$ICMP_RESPONSE_TIME_WARN}'
              value: '0.15'
            - macro: '{$MQTT_BROKER_HOST}'
              value: 'tcp://localhost:1883'
              description: MQTT broker host
            - macro: '{$MQTT_BROKER_PASS}'
              type: SECRET_TEXT
              description: 'MQTT broker password, if configured'
            - macro: '{$MQTT_BROKER_USER}'
              description: 'MQTT broker user, if configured'
            - macro: '{$MQTT_DEVICE_ID}'
              description: Shelly device MQTT ID
            - macro: '{$SHELLY_HOST}'
              description: Device host
            - macro: '{$SHELLY_PASS}'
              type: SECRET_TEXT
              description: 'Device password, if configured'
            - macro: '{$SHELLY_USER}'
              value: admin
              description: 'Device user, if configured'
        valuemaps:
          valuemap:
            - uuid: 89a0bf3bd4ad4ff097c9ccd100e361d2
              name: Received Signal Strength Indicator
              mappings:
                mapping:
                  - type: GREATER_OR_EQUAL
                    value: '-30'
                    newvalue: Amazing
                  - type: GREATER_OR_EQUAL
                    value: '-67'
                    newvalue: Very Good
                  - type: GREATER_OR_EQUAL
                    value: '-70'
                    newvalue: Good
                  - type: GREATER_OR_EQUAL
                    value: '-80'
                    newvalue: Not Good
                  - type: LESS_OR_EQUAL
                    value: '-81'
                    newvalue: Unusable
            - uuid: c5c4dc08a6114690af2e1f7e30a2114a
              name: Self-check
              mappings:
                mapping:
                  - value: '1'
                    newvalue: Working
                  - value: '0'
                    newvalue: Not working
  triggers:
    trigger:
      - uuid: 71c7888b78754f749eba7cdc6da77e13
        expression: last(/Template Shelly Motion/sensor.motion)=1
        recovery_mode: RECOVERY_EXPRESSION
        recovery_expression: >-
          sum(/Template Shelly Motion/sensor.motion,10m)=0 or last(/Template
          Shelly Motion/sensor.active)="false"
        name: Motion detected
        priority: HIGH
        tags:
          tag:
            tag: Application
            value: Motion sensor
      - uuid: c3d1e7a6d70f4a35946c8c734af6a1f6
        expression: >-
          last(/Template Shelly Motion/sensor.vibration)=1 and last(/Template
          Shelly Motion/sensor.active)="true"
        recovery_mode: RECOVERY_EXPRESSION
        recovery_expression: >-
          sum(/Template Shelly Motion/sensor.vibration,10m)=0 or last(/Template
          Shelly Motion/sensor.active)="false"
        name: Tampering detected
        priority: HIGH
        tags:
          tag:
            tag: Application
            value: Motion sensor
  graphs:
    graph:
      uuid: d37485c728f14dc6afd45ccbf80d0089
      name: Total power consumption
      graph_items:
        graph_item:
          - sortorder: '1'
            color: 6C59DC
            item:
              host: Template Shelly 3EM
              key: total_power
          - sortorder: '2'
            color: C7A72D
            item:
              host: Template Shelly 3EM
              key: emeters-0.power
          - sortorder: '3'
            color: BA2A5D
            item:
              host: Template Shelly 3EM
              key: emeters-1.power
          - sortorder: '4'
            color: F230E0
            item:
              host: Template Shelly 3EM
              key: emeters-2.power
          - sortorder: '5'
            color: 5CCD18
            item:
              host: Template Shelly 3EM
              key: emeters-3.power
