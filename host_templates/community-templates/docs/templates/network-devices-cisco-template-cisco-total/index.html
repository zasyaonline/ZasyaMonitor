<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Cisco Total</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="/assets/js/jquery.min.js"></script>
</head>

<body id="body">
  
  
  
  <a href="https://github.com/zabbix/community-templates/tree/main/Network_Devices/Cisco/template_cisco_total">
    <section class="banner-integrations">
	<div class="w container conference-header" id="training_overview" style="padding-top: 60px; min-height: 150px;">
		<div class="banner-content" style="padding-left: 0; padding-bottom: 16px;">
			<h1 class="h1 center">Cisco Total</h1>
		</div>
		<!-- <div class="w container">
			<div class="content text">
				<div class="grid grid-space-category center">
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:network </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:servers </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:infrastructure </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">title:Cisco </a>
					</div>
					
				</div>
			</div>
		</div> -->
	</div>
</section>
  </a>
  <div class="w container">
    <h2 class="h2">Available versions</h2>
    <br>
    <div class="tabs-section">
      <div id="integrations_tabs" class="tabs">
        <ul>
          
          
          <li>
            <a class="js_tab" id="ver_5_0" href="#body">ver. 5.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_6_0" href="#body">ver. 6.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_5_4" href="#body">ver. 5.4
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    <br>
    <br>
    
    
    <div id="content_ver_5_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-cisco-template-cisco-total">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Cisco/template_cisco_total/5.0/template_cisco_total.xml">Download</a>
      </div>
      
      



<h1 id="cisco-total">Cisco Total</h1>

<h2 id="overview">Overview</h2>

<p>This template is a smattering of a few templates combined with some custom discovery rules.</p>

<p>It has been tested to work with a bunch of Cisco switches and routers. It uses the standard SNMP root for all discovery (using OID’s), so it works with most switch/router devices. If you have any issues with it let me know. I exported this from a live system, so the read the dependencies below.</p>

<p><strong>What it does:</strong></p>

<ul>
  <li>BGP Discovery
    <ul>
      <li>Admin Status</li>
      <li>Peer State</li>
    </ul>
  </li>
  <li>CPU Discovery
    <ul>
      <li>Usage on core</li>
    </ul>
  </li>
  <li>Interface Discovery
    <ul>
      <li>Traffic in/out</li>
      <li>Errors in/out</li>
      <li>Drops in/out</li>
    </ul>
  </li>
  <li>Memory Pool Discovery
    <ul>
      <li>Mem free in pool</li>
    </ul>
  </li>
  <li>OSPF Discovery
    <ul>
      <li>Neighbor State</li>
    </ul>
  </li>
  <li>Temperature Discovery
    <ul>
      <li>temperature of monitor</li>
    </ul>
  </li>
</ul>

<p>The template creates quite a few graph prototypes and adds them to a screen as well.</p>

<p><strong>Dependencies:</strong></p>

<p>The template had value maps, interface filters and groups associated with it when I cloned it, but I removed them so there shouldn’t be any issues with it. If you find an issue importing let me know. I was successful importing default template to a new system.</p>

<p><strong>Other Instructions:</strong></p>

<p>Be sure to set the $SNMP_COMMUNITY and $CRD_SNMPV2_R values. They should both be your SNMP community string.</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$CPU_PUSED_MAX_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">85</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CPU_PUSED_MAX_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">95</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CRD_SNMPV2_R}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">5000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1400000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">3000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">500000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SNMP_COMMUNITY}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco Temperature Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.TempDesc&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco CPU Discovery</td>
      <td>&lt;p&gt;{#CPUID} –&gt; The physical entity can be a CPU chip, a group of CPUs, a CPU card etc. The exact type of this entity is described by its entPhysicalVendorType value.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotalTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco Interface Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.ifDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco BGP Peer Enumeration</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.bgpDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco OSPF Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cisco.ospf.diuscovery&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco memory pool discovery</td>
      <td>&lt;p&gt;{#MEMNAME} –&gt; A textual name assigned to the memory pool. This object is suitable for output to a human operator, and may also be used to distinguish among the various pool types, especially among dynamic pools.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{#SNMPINDEX} temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>1.3.6.1.4.1.9.9.13.1.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>CPU - usage on core ‘{#CPUID}’</td>
      <td>&lt;p&gt;The overall CPU busy percentage in the last 5 minute period.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotal5minRev[{#SNMPINDEX}]&lt;p&gt;Update: 300&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.10.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.13.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.14.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.16.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.19.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.20.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Peer State {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.2.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Admin Status {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>ospfNbrState {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.14.10.1.6.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Memory - free in pool ‘{#MEMNAME}’</td>
      <td>&lt;p&gt;Indicates the number of bytes from the memory pool that are currently unused on the managed device.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolFree[{#SNMPINDEX}]&lt;p&gt;Update: 600&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:ciscoMemoryPoolFree[{#SNMPINDEX}].max(#3)}&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:ciscoMemoryPoolFree[{#SNMPINDEX}].max(#3)}&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:cpmCPUTotal5minRev[{#SNMPINDEX}].min(#3)}&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:cpmCPUTotal5minRev[{#SNMPINDEX}].min(#3)}&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:cpmCPUTotal5minRev[{#SNMPINDEX}].min(#3)}&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:cpmCPUTotal5minRev[{#SNMPINDEX}].min(#3)}&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:ciscoMemoryPoolFree[{#SNMPINDEX}].max(#3)}&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Cisco Total:ciscoMemoryPoolFree[{#SNMPINDEX}].max(#3)}&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_6_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-cisco-template-cisco-total">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Cisco/template_cisco_total/6.0/template_cisco_total.yaml">Download</a>
      </div>
      
      



<h1 id="cisco-total">Cisco Total</h1>

<h2 id="overview">Overview</h2>

<p>This template is a smattering of a few templates combined with some custom discovery rules.</p>

<p>It has been tested to work with a bunch of Cisco switches and routers. It uses the standard SNMP root for all discovery (using OID’s), so it works with most switch/router devices. If you have any issues with it let me know. I exported this from a live system, so the read the dependencies below.</p>

<p><strong>What it does:</strong></p>

<ul>
  <li>BGP Discovery
    <ul>
      <li>Admin Status</li>
      <li>Peer State</li>
    </ul>
  </li>
  <li>CPU Discovery
    <ul>
      <li>Usage on core</li>
    </ul>
  </li>
  <li>Interface Discovery
    <ul>
      <li>Traffic in/out</li>
      <li>Errors in/out</li>
      <li>Drops in/out</li>
    </ul>
  </li>
  <li>Memory Pool Discovery
    <ul>
      <li>Mem free in pool</li>
    </ul>
  </li>
  <li>OSPF Discovery
    <ul>
      <li>Neighbor State</li>
    </ul>
  </li>
  <li>Temperature Discovery
    <ul>
      <li>temperature of monitor</li>
    </ul>
  </li>
</ul>

<p>The template creates quite a few graph prototypes and adds them to a screen as well.</p>

<p><strong>Dependencies:</strong></p>

<p>The template had value maps, interface filters and groups associated with it when I cloned it, but I removed them so there shouldn’t be any issues with it. If you find an issue importing let me know. I was successful importing default template to a new system.</p>

<p><strong>Other Instructions:</strong></p>

<p>Be sure to set the $SNMP_COMMUNITY and $CRD_SNMPV2_R values. They should both be your SNMP community string.</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$CPU_PUSED_MAX_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">85</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CPU_PUSED_MAX_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">95</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CRD_SNMPV2_R}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">5000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1400000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">3000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">500000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SNMP_COMMUNITY}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco CPU Discovery</td>
      <td>&lt;p&gt;{#CPUID} –&gt; The physical entity can be a CPU chip, a group of CPUs, a CPU card etc. The exact type of this entity is described by its entPhysicalVendorType value.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotalTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco Interface Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.ifDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco memory pool discovery</td>
      <td>&lt;p&gt;{#MEMNAME} –&gt; A textual name assigned to the memory pool. This object is suitable for output to a human operator, and may also be used to distinguish among the various pool types, especially among dynamic pools.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco OSPF Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cisco.ospf.diuscovery&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco BGP Peer Enumeration</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.bgpDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco Temperature Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.TempDesc&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CPU - usage on core ‘{#CPUID}’</td>
      <td>&lt;p&gt;The overall CPU busy percentage in the last 5 minute period.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotal5minRev[{#SNMPINDEX}]&lt;p&gt;Update: 300&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.10.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.13.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.14.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.16.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.19.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.20.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Memory - free in pool ‘{#MEMNAME}’</td>
      <td>&lt;p&gt;Indicates the number of bytes from the memory pool that are currently unused on the managed device.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolFree[{#SNMPINDEX}]&lt;p&gt;Update: 600&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>ospfNbrState {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.14.10.1.6.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Peer State {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.2.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Admin Status {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPINDEX} temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>1.3.6.1.4.1.9.9.13.1.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_5_4" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-cisco-template-cisco-total">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Cisco/template_cisco_total/5.4/template_cisco_total.yaml">Download</a>
      </div>
      
      



<h1 id="cisco-total">Cisco Total</h1>

<h2 id="overview">Overview</h2>

<p>This template is a smattering of a few templates combined with some custom discovery rules.</p>

<p>It has been tested to work with a bunch of Cisco switches and routers. It uses the standard SNMP root for all discovery (using OID’s), so it works with most switch/router devices. If you have any issues with it let me know. I exported this from a live system, so the read the dependencies below.</p>

<p><strong>What it does:</strong></p>

<ul>
  <li>BGP Discovery
    <ul>
      <li>Admin Status</li>
      <li>Peer State</li>
    </ul>
  </li>
  <li>CPU Discovery
    <ul>
      <li>Usage on core</li>
    </ul>
  </li>
  <li>Interface Discovery
    <ul>
      <li>Traffic in/out</li>
      <li>Errors in/out</li>
      <li>Drops in/out</li>
    </ul>
  </li>
  <li>Memory Pool Discovery
    <ul>
      <li>Mem free in pool</li>
    </ul>
  </li>
  <li>OSPF Discovery
    <ul>
      <li>Neighbor State</li>
    </ul>
  </li>
  <li>Temperature Discovery
    <ul>
      <li>temperature of monitor</li>
    </ul>
  </li>
</ul>

<p>The template creates quite a few graph prototypes and adds them to a screen as well.</p>

<p><strong>Dependencies:</strong></p>

<p>The template had value maps, interface filters and groups associated with it when I cloned it, but I removed them so there shouldn’t be any issues with it. If you find an issue importing let me know. I was successful importing default template to a new system.</p>

<p><strong>Other Instructions:</strong></p>

<p>Be sure to set the $SNMP_COMMUNITY and $CRD_SNMPV2_R values. They should both be your SNMP community string.</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$CPU_PUSED_MAX_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">85</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CPU_PUSED_MAX_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">95</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$CRD_SNMPV2_R}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">5000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1400000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_1:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">3000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”I/O”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">500000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$MEM_FREE_MIN_2:”SRAM”}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">1000</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SNMP_COMMUNITY}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">FillMeIn</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco CPU Discovery</td>
      <td>&lt;p&gt;{#CPUID} –&gt; The physical entity can be a CPU chip, a group of CPUs, a CPU card etc. The exact type of this entity is described by its entPhysicalVendorType value.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotalTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco Interface Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.ifDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco memory pool discovery</td>
      <td>&lt;p&gt;{#MEMNAME} –&gt; A textual name assigned to the memory pool. This object is suitable for output to a human operator, and may also be used to distinguish among the various pool types, especially among dynamic pools.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolTable&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco OSPF Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cisco.ospf.diuscovery&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco BGP Peer Enumeration</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.bgpDescr&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Cisco Temperature Discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>discovery.TempDesc&lt;p&gt;Update: 3600&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CPU - usage on core ‘{#CPUID}’</td>
      <td>&lt;p&gt;The overall CPU busy percentage in the last 5 minute period.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>cpmCPUTotal5minRev[{#SNMPINDEX}]&lt;p&gt;Update: 300&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.10.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.13.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Inbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.14.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound traffic</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.16.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound discarded packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.19.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPVALUE} - Outbound error packets</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.2.2.1.20.[{#SNMPINDEX}]&lt;p&gt;Update: 60&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Memory - free in pool ‘{#MEMNAME}’</td>
      <td>&lt;p&gt;Indicates the number of bytes from the memory pool that are currently unused on the managed device.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ciscoMemoryPoolFree[{#SNMPINDEX}]&lt;p&gt;Update: 600&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>ospfNbrState {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.14.10.1.6.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Peer State {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.2.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>BGP Admin Status {#SNMPINDEX}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>.1.3.6.1.2.1.15.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#SNMPINDEX} temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>1.3.6.1.4.1.9.9.13.1.3.1.3.[{#SNMPINDEX}]&lt;p&gt;Update: 30&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}]</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;85&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘CPU usage’ on core ‘{#CPUID}’ is too high [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;- Check for a possible security issue. Commonly, high CPU utilization is caused by a security issue, such as a worm or virus operating in your network. This is especially likely to be the cause if there have not been recent changes to the network. Usually, a configuration change, such as adding additional lines to your access lists can mitigate the effects of this problem. Cisco Product Security Advisories and Notices contains information on detection of the most likely causes and specific workarounds. - Make sure all debugging commands in your router are turned off by issuing the undebug all or no debug all commands. For more information on the use of debugging commands, refer to Using Debug Commands. - Are you able to issue show commands on the router? If yes, start collecting more information immediately, using these show commands. - Is the router inaccessible? Can you reproduce this problem? If yes, power-cycle the router and, before reproducing the problem, configure the scheduler interval 500 command. This schedules low priority processes to run every 500 milliseconds, which provides time for you to run some commands, even if CPU usage is at 100 percent. On Cisco 7200 and Cisco 7500 Series Routers, use the scheduler allocate 3000 1000 command. - Does the router show symptoms of high CPU utilization at brief and unpredictable intervals? If yes, periodically collect the output of the show processes cpu command, which shows if the high CPU utilization is caused by interrupts or by a certain process. Use this UNIX script and, based on the first findings, modify the script to collect data needed for further investigation of the issue. The overall CPU busy percentage.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: min(/Cisco Total/cpmCPUTotal5minRev[{#SNMPINDEX}],#3)&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;5000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Cisco: ‘Free memory’ in pool ‘{#MEMNAME}’ is too low [{ITEM.LASTVALUE}] (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: max(/Cisco Total/ciscoMemoryPoolFree[{#SNMPINDEX}],#3)&lt;1000000&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
  </tbody>
</table>


    </div>
    
  </div>
  <script>
    (function () {
      
      //console.log('#content_ver_5_4');
      //console.log('#ver_5_4');
      $('.readme').hide();
      $('#content_ver_5_4').fadeIn('slow');
      $('#ver_5_4').addClass('active');

      
      $('#ver_5_0').click(function () {
        //console.log('#content_ver_5_0');
        //console.log('#ver_5_0');
        $('.readme').hide();
        $('#content_ver_5_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_0').addClass('active');
      })
      
      $('#ver_6_0').click(function () {
        //console.log('#content_ver_6_0');
        //console.log('#ver_6_0');
        $('.readme').hide();
        $('#content_ver_6_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_6_0').addClass('active');
      })
      
      $('#ver_5_4').click(function () {
        //console.log('#content_ver_5_4');
        //console.log('#ver_5_4');
        $('.readme').hide();
        $('#content_ver_5_4').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_4').addClass('active');
      })
      
    })();
  </script>
</body>

</html>