<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>enhanced_snmp_interface_discovery</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="/assets/js/jquery.min.js"></script>
</head>

<body id="body">
  
  
  
  <a href="https://github.com/zabbix/community-templates/tree/main/Network_Devices/Other/template_enhanced_snmp_interface_discovery">
    <section class="banner-integrations">
	<div class="w container conference-header" id="training_overview" style="padding-top: 60px; min-height: 150px;">
		<div class="banner-content" style="padding-left: 0; padding-bottom: 16px;">
			<h1 class="h1 center">enhanced_snmp_interface_discovery</h1>
		</div>
		<!-- <div class="w container">
			<div class="content text">
				<div class="grid grid-space-category center">
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:network </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:infrastructure </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">title:SNMP </a>
					</div>
					
				</div>
			</div>
		</div> -->
	</div>
</section>
  </a>
  <div class="w container">
    <h2 class="h2">Available versions</h2>
    <br>
    <div class="tabs-section">
      <div id="integrations_tabs" class="tabs">
        <ul>
          
          
          <li>
            <a class="js_tab" id="ver_5_0" href="#body">ver. 5.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_6_0" href="#body">ver. 6.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_5_4" href="#body">ver. 5.4
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    <br>
    <br>
    
    
    <div id="content_ver_5_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-other-template-enhanced-snmp-interface-discovery">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Other/template_enhanced_snmp_interface_discovery/5.0/template_enhanced_snmp_interface_discovery.xml">Download</a>
      </div>
      
      



<h1 id="enhanced-snmp-interface-discovery">Enhanced SNMP Interface Discovery</h1>

<h2 id="description">Description</h2>

<p>Enhanced SNMP interface discovery 1.0.1 Template made by Twan Kamans. https://www.twan-it.nl This template searches for 4 different categories: - Interfaces that are administratively disabled - Interfaces that are working onder normal condition - Interfaces with priority, such as switch uplink - Virtual interfaces such as tunnel, port channel and vlan interfaces. Revision 0.7 - Added support for virtual interfaces Revision 0.7.1 - Added support for (filtering) stack switch ports - Fixed a bug in which VLAN interfaces with the number 0 in them would still be discovered by the normal LLD rule Revision 0.7.2 - Filtering VLAN’s 1002 - 1005 interfaces - Added support for subinterfaces for Junos Revision 0.8 - Completely revisited the filtering of items using Regex due to introduction of Junos devices. You can adjust the regex for physical devices using a macro. Revision 0.9 - Added support for enduser ports. Triggers will not activate if port description contains macro value. Revision 1.0 - Tested template on posible errors. Revision 1.0.1 - Added bandwidth statistics for virtual interfaces. Revision 1.0.2 - Bandwidth triggers now make use of user macro context, making individual port bandwidth limits posible. - The interface changed state severity has been lowered by default. The new default severity for all interfaces is “warning”. Exceptions to this are the priority interfaces which are “average”.</p>

<h2 id="overview">Overview</h2>

<p>This template is a replacement for the great default SNMP interface template. It uses the default SNMP interface library and OID’s, meaning that it’s compatible with a lot of devices.</p>

<p>The template has the following features:</p>

<ul>
  <li>Priority interfaces (assign higher severity triggers to your important interfaces)</li>
  <li>Get notified when a user no-shut’s a port</li>
  <li>Get notified when a port is in the not-connected state</li>
  <li>Get notified when the bandwidth of a port reaches a specific threshold in percentage (port specific using user macro context)</li>
  <li>Get notified when a port changes that (up / down)</li>
  <li>Adjustable LLD timer for working on port configurations which quickly need to be discovered by Zabbix</li>
  <li>Only gather data for items and interfaces that are important: i don’t want to monitor loopback interfaces and the amount of incoming errors on a port-channel (notsupported items)</li>
  <li>Don’t trigger on (switch)ports which have users behind them. I don’t want to know when someone turns their computer off.</li>
</ul>

<p>Most of these features can be adjusted and enabled / disabled using macro’s:</p>

<ul>
  <li>{$INT_BANDWIDTH_WARNING}</li>
  <li>{$INT_ERRORS_WARN}</li>
  <li>{$INT_LLD_UPDATE_INTERVAL}</li>
  <li>{$INT_NAME_PHYSICAL}</li>
  <li>{$INT_NO_TRIGGER_STRING}</li>
  <li>{$INT_PRIO_STRING}</li>
  <li>{$SEARCH_FOR_INACTIVE_PORTS}</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>Macro name</td>
      <td>Default value</td>
      <td>Type</td>
      <td>Description</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>80</td>
      <td>Percentage</td>
      <td>Percentage when trigger fires</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARM}</td>
      <td>2</td>
      <td>#Amount</td>
      <td>Max error value for “interface errors trigger”</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>30m</td>
      <td>Time</td>
      <td>Update interval for LLD rules</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>^[A-Z</td>
      <td>a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</td>
      <td>Regex</td>
      <td>Regex that filters the physical interfaces</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>^(EDGEPORT)$</td>
      <td>Regex</td>
      <td>Regex for edge ports (computers turning on / off)</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>UPLINK</td>
      <td>Regex</td>
      <td>Description keyword for priority interfaces</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>0</td>
      <td>Bolean</td>
      <td>0 = Does not trigger for notconnected ports (1 does)</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>With the default values, interface descriptions that start with “UPLINK” will be discovered by the Priority LLD. Interfaces that contain the keyword EDGEPORT will not generate a trigger when turned on / off.</p>

<p>If you miss some interfaces: run a SNMPWALK over the device to check if it matches the {$INT_NAME_PHYSICAL} regex!</p>

<h2 id="author">Author</h2>

<p>Twan Kamans</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">80</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARN}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">2</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">30m</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^[A-Z|a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^(EDGEPORT)$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">UPLINK</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Network Interfaces Discovery - Priority</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Virtual</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Normal</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Disabled</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Total amount of interfaces</td>
      <td>&lt;p&gt;Shows the total amount of interfaces.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.total&lt;p&gt;Update: 10m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifDescription.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Speed</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Speed</td>
      <td>&lt;p&gt;Speed of the interface&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;Shows if interface is administrative disabled.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {enhanced_snmp_interface_discovery:net.if.status[ifAlias.{#SNMPINDEX}].regexp(“^(EDGEPORT)$”,#3)}=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].last(#5)}&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)<em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)</em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) and {enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)<em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)</em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()})&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInErrors.{#SNMPINDEX}].avg(5m)}&gt;2 or {enhanced_snmp_interface_discovery:net.if.status[ifOutErrors.{#SNMPINDEX}].avg(5m)}&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected!</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifAdminStatus.{#SNMPINDEX}].last()}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].avg(1w)}=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP!</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.down.status[ifAdminStatus.{#SNMPINDEX}].last()}=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.prio.status[ifOperStatus.{#SNMPINDEX}].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)<em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)</em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) and {enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)<em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)</em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()})&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInErrors.{#SNMPINDEX}].avg(5m)}&gt;2 or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutErrors.{#SNMPINDEX}].avg(5m)}&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].last(5m)}&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.prio.status[ifOperStatus.{#SNMPINDEX}].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)<em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)</em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) and {enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)<em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)</em>{enhanced_snmp_interface_discovery:net.if.prio.status[ifSpeed.{#SNMPINDEX}].last()})&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.prio.status[ifInErrors.{#SNMPINDEX}].avg(5m)}&gt;2 or {enhanced_snmp_interface_discovery:net.if.prio.status[ifOutErrors.{#SNMPINDEX}].avg(5m)}&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.virt.status[ifOperStatus.{#SNMPINDEX}].last(5m)}&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].avg(3600)}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].last()}=2 and {enhanced_snmp_interface_discovery:net.if.status[ifAlias.{#SNMPINDEX}].regexp(“^(EDGEPORT)$”,#3)}=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].last(#5)}&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)<em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&gt;((80/100)</em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) and {enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)<em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()}) or {enhanced_snmp_interface_discovery:net.if.status[ifOutOctets.{#SNMPINDEX}].avg(10m)}&lt;(((80-3)/100)</em>{enhanced_snmp_interface_discovery:net.if.status[ifSpeed.{#SNMPINDEX}].last()})&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifInErrors.{#SNMPINDEX}].avg(5m)}&gt;2 or {enhanced_snmp_interface_discovery:net.if.status[ifOutErrors.{#SNMPINDEX}].avg(5m)}&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected! (LLD)</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.status[ifAdminStatus.{#SNMPINDEX}].last()}&lt;&gt;2 and {enhanced_snmp_interface_discovery:net.if.status[ifOperStatus.{#SNMPINDEX}].avg(1w)}=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP! (LLD)</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {enhanced_snmp_interface_discovery:net.if.down.status[ifAdminStatus.{#SNMPINDEX}].last()}=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_6_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-other-template-enhanced-snmp-interface-discovery">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Other/template_enhanced_snmp_interface_discovery/6.0/template_enhanced_snmp_interface_discovery.yaml">Download</a>
      </div>
      
      



<h1 id="enhanced-snmp-interface-discovery">Enhanced SNMP Interface Discovery</h1>

<h2 id="description">Description</h2>

<p>Enhanced SNMP interface discovery 1.0.1 Template made by Twan Kamans. https://www.twan-it.nl This template searches for 4 different categories: - Interfaces that are administratively disabled - Interfaces that are working onder normal condition - Interfaces with priority, such as switch uplink - Virtual interfaces such as tunnel, port channel and vlan interfaces. Revision 0.7 - Added support for virtual interfaces Revision 0.7.1 - Added support for (filtering) stack switch ports - Fixed a bug in which VLAN interfaces with the number 0 in them would still be discovered by the normal LLD rule Revision 0.7.2 - Filtering VLAN’s 1002 - 1005 interfaces - Added support for subinterfaces for Junos Revision 0.8 - Completely revisited the filtering of items using Regex due to introduction of Junos devices. You can adjust the regex for physical devices using a macro. Revision 0.9 - Added support for enduser ports. Triggers will not activate if port description contains macro value. Revision 1.0 - Tested template on posible errors. Revision 1.0.1 - Added bandwidth statistics for virtual interfaces. Revision 1.0.2 - Bandwidth triggers now make use of user macro context, making individual port bandwidth limits posible. - The interface changed state severity has been lowered by default. The new default severity for all interfaces is “warning”. Exceptions to this are the priority interfaces which are “average”.</p>

<h2 id="overview">Overview</h2>

<p>This template is a replacement for the great default SNMP interface template. It uses the default SNMP interface library and OID’s, meaning that it’s compatible with a lot of devices.</p>

<p>The template has the following features:</p>

<ul>
  <li>Priority interfaces (assign higher severity triggers to your important interfaces)</li>
  <li>Get notified when a user no-shut’s a port</li>
  <li>Get notified when a port is in the not-connected state</li>
  <li>Get notified when the bandwidth of a port reaches a specific threshold in percentage (port specific using user macro context)</li>
  <li>Get notified when a port changes that (up / down)</li>
  <li>Adjustable LLD timer for working on port configurations which quickly need to be discovered by Zabbix</li>
  <li>Only gather data for items and interfaces that are important: i don’t want to monitor loopback interfaces and the amount of incoming errors on a port-channel (notsupported items)</li>
  <li>Don’t trigger on (switch)ports which have users behind them. I don’t want to know when someone turns their computer off.</li>
</ul>

<p>Most of these features can be adjusted and enabled / disabled using macro’s:</p>

<ul>
  <li>{$INT_BANDWIDTH_WARNING}</li>
  <li>{$INT_ERRORS_WARN}</li>
  <li>{$INT_LLD_UPDATE_INTERVAL}</li>
  <li>{$INT_NAME_PHYSICAL}</li>
  <li>{$INT_NO_TRIGGER_STRING}</li>
  <li>{$INT_PRIO_STRING}</li>
  <li>{$SEARCH_FOR_INACTIVE_PORTS}</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>Macro name</td>
      <td>Default value</td>
      <td>Type</td>
      <td>Description</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>80</td>
      <td>Percentage</td>
      <td>Percentage when trigger fires</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARM}</td>
      <td>2</td>
      <td>#Amount</td>
      <td>Max error value for “interface errors trigger”</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>30m</td>
      <td>Time</td>
      <td>Update interval for LLD rules</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>^[A-Z</td>
      <td>a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</td>
      <td>Regex</td>
      <td>Regex that filters the physical interfaces</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>^(EDGEPORT)$</td>
      <td>Regex</td>
      <td>Regex for edge ports (computers turning on / off)</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>UPLINK</td>
      <td>Regex</td>
      <td>Description keyword for priority interfaces</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>0</td>
      <td>Bolean</td>
      <td>0 = Does not trigger for notconnected ports (1 does)</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>With the default values, interface descriptions that start with “UPLINK” will be discovered by the Priority LLD. Interfaces that contain the keyword EDGEPORT will not generate a trigger when turned on / off.</p>

<p>If you miss some interfaces: run a SNMPWALK over the device to check if it matches the {$INT_NAME_PHYSICAL} regex!</p>

<h2 id="author">Author</h2>

<p>Twan Kamans</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">80</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARN}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">2</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">30m</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^[A-Z|a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^(EDGEPORT)$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">UPLINK</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Network Interfaces Discovery - Priority</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Virtual</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Disabled</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Normal</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Total amount of interfaces</td>
      <td>&lt;p&gt;Shows the total amount of interfaces.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.total&lt;p&gt;Update: 10m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifDescription.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Speed</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;Shows if interface is administrative disabled.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Speed</td>
      <td>&lt;p&gt;Speed of the interface&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and find(/enhanced_snmp_interface_discovery/net.if.status[ifAlias.{#SNMPINDEX}],#3,”regexp”,”^(EDGEPORT)$”)=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],#5)&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected!</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifAdminStatus.{#SNMPINDEX}])&lt;&gt;2 and avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],1w)=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP!</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.down.status[ifAdminStatus.{#SNMPINDEX}])=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP! (LLD)</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.down.status[ifAdminStatus.{#SNMPINDEX}])=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and find(/enhanced_snmp_interface_discovery/net.if.status[ifAlias.{#SNMPINDEX}],#3,”regexp”,”^(EDGEPORT)$”)=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],#5)&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected! (LLD)</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifAdminStatus.{#SNMPINDEX}])&lt;&gt;2 and avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],1w)=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_5_4" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-other-template-enhanced-snmp-interface-discovery">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Other/template_enhanced_snmp_interface_discovery/5.4/template_enhanced_snmp_interface_discovery.yaml">Download</a>
      </div>
      
      



<h1 id="enhanced-snmp-interface-discovery">Enhanced SNMP Interface Discovery</h1>

<h2 id="description">Description</h2>

<p>Enhanced SNMP interface discovery 1.0.1 Template made by Twan Kamans. https://www.twan-it.nl This template searches for 4 different categories: - Interfaces that are administratively disabled - Interfaces that are working onder normal condition - Interfaces with priority, such as switch uplink - Virtual interfaces such as tunnel, port channel and vlan interfaces. Revision 0.7 - Added support for virtual interfaces Revision 0.7.1 - Added support for (filtering) stack switch ports - Fixed a bug in which VLAN interfaces with the number 0 in them would still be discovered by the normal LLD rule Revision 0.7.2 - Filtering VLAN’s 1002 - 1005 interfaces - Added support for subinterfaces for Junos Revision 0.8 - Completely revisited the filtering of items using Regex due to introduction of Junos devices. You can adjust the regex for physical devices using a macro. Revision 0.9 - Added support for enduser ports. Triggers will not activate if port description contains macro value. Revision 1.0 - Tested template on posible errors. Revision 1.0.1 - Added bandwidth statistics for virtual interfaces. Revision 1.0.2 - Bandwidth triggers now make use of user macro context, making individual port bandwidth limits posible. - The interface changed state severity has been lowered by default. The new default severity for all interfaces is “warning”. Exceptions to this are the priority interfaces which are “average”.</p>

<h2 id="overview">Overview</h2>

<p>This template is a replacement for the great default SNMP interface template. It uses the default SNMP interface library and OID’s, meaning that it’s compatible with a lot of devices.</p>

<p>The template has the following features:</p>

<ul>
  <li>Priority interfaces (assign higher severity triggers to your important interfaces)</li>
  <li>Get notified when a user no-shut’s a port</li>
  <li>Get notified when a port is in the not-connected state</li>
  <li>Get notified when the bandwidth of a port reaches a specific threshold in percentage (port specific using user macro context)</li>
  <li>Get notified when a port changes that (up / down)</li>
  <li>Adjustable LLD timer for working on port configurations which quickly need to be discovered by Zabbix</li>
  <li>Only gather data for items and interfaces that are important: i don’t want to monitor loopback interfaces and the amount of incoming errors on a port-channel (notsupported items)</li>
  <li>Don’t trigger on (switch)ports which have users behind them. I don’t want to know when someone turns their computer off.</li>
</ul>

<p>Most of these features can be adjusted and enabled / disabled using macro’s:</p>

<ul>
  <li>{$INT_BANDWIDTH_WARNING}</li>
  <li>{$INT_ERRORS_WARN}</li>
  <li>{$INT_LLD_UPDATE_INTERVAL}</li>
  <li>{$INT_NAME_PHYSICAL}</li>
  <li>{$INT_NO_TRIGGER_STRING}</li>
  <li>{$INT_PRIO_STRING}</li>
  <li>{$SEARCH_FOR_INACTIVE_PORTS}</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>Macro name</td>
      <td>Default value</td>
      <td>Type</td>
      <td>Description</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>80</td>
      <td>Percentage</td>
      <td>Percentage when trigger fires</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARM}</td>
      <td>2</td>
      <td>#Amount</td>
      <td>Max error value for “interface errors trigger”</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>30m</td>
      <td>Time</td>
      <td>Update interval for LLD rules</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>^[A-Z</td>
      <td>a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</td>
      <td>Regex</td>
      <td>Regex that filters the physical interfaces</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>^(EDGEPORT)$</td>
      <td>Regex</td>
      <td>Regex for edge ports (computers turning on / off)</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>UPLINK</td>
      <td>Regex</td>
      <td>Description keyword for priority interfaces</td>
      <td> </td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>0</td>
      <td>Bolean</td>
      <td>0 = Does not trigger for notconnected ports (1 does)</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>With the default values, interface descriptions that start with “UPLINK” will be discovered by the Priority LLD. Interfaces that contain the keyword EDGEPORT will not generate a trigger when turned on / off.</p>

<p>If you miss some interfaces: run a SNMPWALK over the device to check if it matches the {$INT_NAME_PHYSICAL} regex!</p>

<h2 id="author">Author</h2>

<p>Twan Kamans</p>

<h2 id="macros-used">Macros used</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Default</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{$INT_BANDWIDTH_WARNING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">80</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_ERRORS_WARN}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">2</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_LLD_UPDATE_INTERVAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">30m</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NAME_PHYSICAL}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^[A-Z|a-z]{2}-?[0-9]+\/[0-9]{1,2}(\/[0-9]+)?$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_NO_TRIGGER_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">^(EDGEPORT)$</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$INT_PRIO_STRING}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">UPLINK</code></td>
      <td>Text macro</td>
    </tr>
    <tr>
      <td>{$SEARCH_FOR_INACTIVE_PORTS}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">0</code></td>
      <td>Text macro</td>
    </tr>
  </tbody>
</table>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Network Interfaces Discovery - Priority</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Virtual</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Disabled</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Network Interfaces Discovery - Normal</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.discovery&lt;p&gt;Update: {$INT_LLD_UPDATE_INTERVAL}&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Total amount of interfaces</td>
      <td>&lt;p&gt;Shows the total amount of interfaces.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.total&lt;p&gt;Update: 10m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifDescription.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME} (priority): Speed</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.prio.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.virt.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;Shows if interface is administrative disabled.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.down.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAdminStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Alias</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifAlias.{#SNMPINDEX}]&lt;p&gt;Update: 1h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Inbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits received</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifInOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Operational status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOperStatus.{#SNMPINDEX}]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets discarded</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutDiscards.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Outbound packets with errors</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutErrors.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bits sent</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifOutOctets.{#SNMPINDEX}]&lt;p&gt;Update: 3m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Speed</td>
      <td>&lt;p&gt;Speed of the interface&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>net.if.status[ifSpeed.{#SNMPINDEX}]&lt;p&gt;Update: 5m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and find(/enhanced_snmp_interface_discovery/net.if.status[ifAlias.{#SNMPINDEX}],#3,”regexp”,”^(EDGEPORT)$”)=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],#5)&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected!</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifAdminStatus.{#SNMPINDEX}])&lt;&gt;2 and avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],1w)=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP!</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.down.status[ifAdminStatus.{#SNMPINDEX}])=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}%</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME}</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on host {HOST.NAME} port {#IFNAME}: {#SNMPVALUE} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.prio.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.prio.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.virt.status[ifOperStatus.{#SNMPINDEX}])&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} has gone UP! (LLD)</td>
      <td>&lt;p&gt;Interface state has changed. This is most likely due to enabeling an interface.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.down.status[ifAdminStatus.{#SNMPINDEX}])=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
    <tr>
      <td>Interface status has changed on port {#IFNAME} (LLD)</td>
      <td>&lt;p&gt;Triggers when the interface state changes.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],3600s)&lt;&gt;2 and last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and find(/enhanced_snmp_interface_discovery/net.if.status[ifAlias.{#SNMPINDEX}],#3,”regexp”,”^(EDGEPORT)$”)=0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],#5)&lt;&gt;2&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: Bandwidth usage over {$INT_BANDWIDTH_WARNING:”{#IFNAME}”}% (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing traffic exceeds limit of the INT_BANDWIDTH_WARNING macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&gt;((80/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&gt;((80/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) and last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])&gt;0&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)<em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}])) or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutOctets.{#SNMPINDEX}],10m)&lt;(((80-3)/100)</em>last(/enhanced_snmp_interface_discovery/net.if.status[ifSpeed.{#SNMPINDEX}]))&lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Interface {#IFNAME}: High error rate (LLD)</td>
      <td>&lt;p&gt;Triggers when incoming or outgoing errors exceeds limit of the INT_ERRORS_WARN macro.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: avg(/enhanced_snmp_interface_discovery/net.if.status[ifInErrors.{#SNMPINDEX}],5m)&gt;2 or avg(/enhanced_snmp_interface_discovery/net.if.status[ifOutErrors.{#SNMPINDEX}],5m)&gt;2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>Port {#IFNAME} is enabled but not connected! (LLD)</td>
      <td>&lt;p&gt;Zabbix detects a “notconnected” port on {HOST.NAME} Interface {#IFNAME}.&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/enhanced_snmp_interface_discovery/net.if.status[ifAdminStatus.{#SNMPINDEX}])&lt;&gt;2 and avg(/enhanced_snmp_interface_discovery/net.if.status[ifOperStatus.{#SNMPINDEX}],1w)=2 and 0=1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>information</td>
    </tr>
  </tbody>
</table>


    </div>
    
  </div>
  <script>
    (function () {
      
      //console.log('#content_ver_5_4');
      //console.log('#ver_5_4');
      $('.readme').hide();
      $('#content_ver_5_4').fadeIn('slow');
      $('#ver_5_4').addClass('active');

      
      $('#ver_5_0').click(function () {
        //console.log('#content_ver_5_0');
        //console.log('#ver_5_0');
        $('.readme').hide();
        $('#content_ver_5_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_0').addClass('active');
      })
      
      $('#ver_6_0').click(function () {
        //console.log('#content_ver_6_0');
        //console.log('#ver_6_0');
        $('.readme').hide();
        $('#content_ver_6_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_6_0').addClass('active');
      })
      
      $('#ver_5_4').click(function () {
        //console.log('#content_ver_5_4');
        //console.log('#ver_5_4');
        $('.readme').hide();
        $('#content_ver_5_4').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_4').addClass('active');
      })
      
    })();
  </script>
</body>

</html>