<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Palo Alto SNMPv2 64-bit counters</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="/assets/js/jquery.min.js"></script>
</head>

<body id="body">
  
  
  
  <a href="https://github.com/zabbix/community-templates/tree/main/Network_Devices/Palo_Alto/template_palo_alto_with_64-bit_counters_(snmpv2)">
    <section class="banner-integrations">
	<div class="w container conference-header" id="training_overview" style="padding-top: 60px; min-height: 150px;">
		<div class="banner-content" style="padding-left: 0; padding-bottom: 16px;">
			<h1 class="h1 center">Palo Alto SNMPv2 64-bit counters</h1>
		</div>
		<!-- <div class="w container">
			<div class="content text">
				<div class="grid grid-space-category center">
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:network </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">category:infrastructure </a>
					</div>
					
					<div class="span">
						<a class="card center category-button" href="" style="color: #25282F">title:Palo Alto Networks </a>
					</div>
					
				</div>
			</div>
		</div> -->
	</div>
</section>
  </a>
  <div class="w container">
    <h2 class="h2">Available versions</h2>
    <br>
    <div class="tabs-section">
      <div id="integrations_tabs" class="tabs">
        <ul>
          
          
          <li>
            <a class="js_tab" id="ver_5_0" href="#body">ver. 5.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_6_0" href="#body">ver. 6.0
            </a>
          </li>
          
          <li>
            <a class="js_tab" id="ver_5_4" href="#body">ver. 5.4
            </a>
          </li>
          
        </ul>
      </div>
    </div>
    <br>
    <br>
    
    
    <div id="content_ver_5_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-palo-alto-template-palo-alto-with-64-bit-counters-snmpv2">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Palo_Alto/template_palo_alto_with_64-bit_counters_(snmpv2)/5.0/template_palo_alto_with_64-bit_counters_(snmpv2).xml">Download</a>
      </div>
      
      



<h1 id="palo-alto-snmpv2-64-bit-counters">Palo Alto SNMPv2 64-bit counters</h1>

<h2 id="overview">Overview</h2>

<p>Hi everyone,</p>

<p>I created this template because i updated two Palo Alto from 8.1.4 to 9.0.3 and some counter went from 32 to 64bits</p>

<p>I just modified the template below from Pavol Rehak so check it out (for details details and trap configuration) :</p>

<p><a href="network_devices/palo-alto/paloalto-snmpv3-zabbix4-0">https://share.zabbix.com/network_devices/palo-alto/paloalto-snmpv3-zabbix4-0</a></p>

<p>I changed all snmpv3 to snmpv2 and added graphs for discovered interface traffic (in &amp; out)</p>

<p>I had some error on storage discovery too that i fixed</p>

<p>###</p>

<p>NAME : Template Palo Alto SNMPv2 64-bit counters</p>

<p>###</p>

<p>TESTED : zabbix 4.2 and PAN OS 9.0.3-h3 but should work on zabbix 3.4 and PAN OS 8.1</p>

<h2 id="author">Author</h2>

<p>Remi Chanoine</p>

<h2 id="macros-used">Macros used</h2>

<p>There are no macros links in this template.</p>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>entPhysical discovery - Temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>hrStorage discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>CPU discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>interface discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>entPhysical discovery - Fan</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery.fan&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Uptime</td>
      <td>&lt;p&gt;“The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrSystemUptime.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Hostname</td>
      <td>&lt;p&gt;An administratively-assigned name for this managed node. By convention, this is the node’s fully-qualified domain name.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysName.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA mode</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAMode.0&lt;p&gt;Update: 12h&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA status trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“HA link change”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA peer state</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAPeerState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>System shutdown</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“System shutdown”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>General trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“General trap”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA state</td>
      <td>&lt;p&gt;Current high-availability state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Undefined traps</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap.fallback&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Device description</td>
      <td>&lt;p&gt;A textual description of the entity. This value should include the full name and version identification of the system’s hardware type, software operating-system, and networking software. It is mandatory that this only contain printable ASCII characters.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysDescr.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;“The operational status of the sensor.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;The most recent measurement obtained by the agent for this sensor.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage size</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageSize.[”{#STOR}”]&lt;p&gt;Update: 30m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage type</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageType.[”{#STOR}”]&lt;p&gt;Update: 12h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage used</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageUsed.[”{#STOR}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} status</td>
      <td>&lt;p&gt;“The current operational state of the device described by this row of the table. A value unknown(1) indicates that the current state of the device is unknown. running(2) indicates that the device is up and running and that no unusual error conditions are known. The warning(3) state indicates that agent has been informed of an unusual error condition by the operational software (e.g., a disk device driver) but that the device is still ‘operational’. An example would be a high number of soft errors on a disk. A value of testing(4), indicates that the device is not available for use because it is in the testing state. The state of down(5) is used only when the agent has been informed that the device is not available for any use.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceStatus.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} load - percentage</td>
      <td>&lt;p&gt;“The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrProcessorLoad.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAdminStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 alias (description)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAlias.[”{#IFNAME}”]&lt;p&gt;Update: 6h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 input traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCInOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 output traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCOutOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 link status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifOperStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.fan.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorOperStatus.[”{#PHY}”].last()}&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorOperStatus.fan.[”{#PHY}”].last()}&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrDeviceStatus.[”{#CPU}”].last()}=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrDeviceStatus.[”{#CPU}”].last()}=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrProcessorLoad.[”{#CPU}”].last()}&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrProcessorLoad.[”{#CPU}”].last()}&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:ifAdminStatus.[”{#IFNAME}”].last()}=1 and {Palo Alto SNMPv2 64-bit counters:ifOperStatus.[”{#IFNAME}”].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorOperStatus.[”{#PHY}”].last()}&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorValue.[”{#PHY}”].last()}&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrStorageUsed.[”{#STOR}”].last()} / {Palo Alto SNMPv2 64-bit counters:hrStorageSize.[”{#STOR}”].last()} * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrDeviceStatus.[”{#CPU}”].last()}=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrDeviceStatus.[”{#CPU}”].last()}=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrProcessorLoad.[”{#CPU}”].last()}&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:hrProcessorLoad.[”{#CPU}”].last()}&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down (LLD)</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:ifAdminStatus.[”{#IFNAME}”].last()}=1 and {Palo Alto SNMPv2 64-bit counters:ifOperStatus.[”{#IFNAME}”].last()}=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: {Palo Alto SNMPv2 64-bit counters:entPhySensorOperStatus.fan.[”{#PHY}”].last()}&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_6_0" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-palo-alto-template-palo-alto-with-64-bit-counters-snmpv2">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Palo_Alto/template_palo_alto_with_64-bit_counters_(snmpv2)/6.0/template_palo_alto_with_64-bit_counters_(snmpv2).yaml">Download</a>
      </div>
      
      



<h1 id="palo-alto-snmpv2-64-bit-counters">Palo Alto SNMPv2 64-bit counters</h1>

<h2 id="overview">Overview</h2>

<p>Hi everyone,</p>

<p>I created this template because i updated two Palo Alto from 8.1.4 to 9.0.3 and some counter went from 32 to 64bits</p>

<p>I just modified the template below from Pavol Rehak so check it out (for details details and trap configuration) :</p>

<p><a href="network_devices/palo-alto/paloalto-snmpv3-zabbix4-0">https://share.zabbix.com/network_devices/palo-alto/paloalto-snmpv3-zabbix4-0</a></p>

<p>I changed all snmpv3 to snmpv2 and added graphs for discovered interface traffic (in &amp; out)</p>

<p>I had some error on storage discovery too that i fixed</p>

<p>###</p>

<p>NAME : Template Palo Alto SNMPv2 64-bit counters</p>

<p>###</p>

<p>TESTED : zabbix 4.2 and PAN OS 9.0.3-h3 but should work on zabbix 3.4 and PAN OS 8.1</p>

<h2 id="author">Author</h2>

<p>Remi Chanoine</p>

<h2 id="macros-used">Macros used</h2>

<p>There are no macros links in this template.</p>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>interface discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>hrStorage discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>entPhysical discovery - Fan</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery.fan&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>CPU discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>entPhysical discovery - Temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Device description</td>
      <td>&lt;p&gt;A textual description of the entity. This value should include the full name and version identification of the system’s hardware type, software operating-system, and networking software. It is mandatory that this only contain printable ASCII characters.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysDescr.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Hostname</td>
      <td>&lt;p&gt;An administratively-assigned name for this managed node. By convention, this is the node’s fully-qualified domain name.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysName.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA peer state</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAPeerState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>General trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“General trap”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA mode</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAMode.0&lt;p&gt;Update: 12h&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Undefined traps</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap.fallback&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA state</td>
      <td>&lt;p&gt;Current high-availability state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA status trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“HA link change”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>System shutdown</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“System shutdown”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Uptime</td>
      <td>&lt;p&gt;“The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrSystemUptime.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAdminStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 alias (description)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAlias.[”{#IFNAME}”]&lt;p&gt;Update: 6h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 input traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCInOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 output traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCOutOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 link status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifOperStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage size</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageSize.[”{#STOR}”]&lt;p&gt;Update: 30m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage type</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageType.[”{#STOR}”]&lt;p&gt;Update: 12h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage used</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageUsed.[”{#STOR}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.fan.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} status</td>
      <td>&lt;p&gt;“The current operational state of the device described by this row of the table. A value unknown(1) indicates that the current state of the device is unknown. running(2) indicates that the device is up and running and that no unusual error conditions are known. The warning(3) state indicates that agent has been informed of an unusual error condition by the operational software (e.g., a disk device driver) but that the device is still ‘operational’. An example would be a high number of soft errors on a disk. A value of testing(4), indicates that the device is not available for use because it is in the testing state. The state of down(5) is used only when the agent has been informed that the device is not available for any use.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceStatus.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} load - percentage</td>
      <td>&lt;p&gt;“The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrProcessorLoad.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;“The operational status of the sensor.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;The most recent measurement obtained by the agent for this sensor.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.fan.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/ifAdminStatus.[”{#IFNAME}”])=1 and last(/Palo Alto SNMPv2 64-bit counters/ifOperStatus.[”{#IFNAME}”])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down (LLD)</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/ifAdminStatus.[”{#IFNAME}”])=1 and last(/Palo Alto SNMPv2 64-bit counters/ifOperStatus.[”{#IFNAME}”])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.fan.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
  </tbody>
</table>


    </div>
    
    
    <div id="content_ver_5_4" class="readme">
      <div class="banner-buttons " style="padding-top: 20px; ">
        <a class="button button-gray" style="color: #ffff;" href="/#network-devices-palo-alto-template-palo-alto-with-64-bit-counters-snmpv2">Back to index</a>
        <a class="button button-green" style="color: #ffff;" href="https://raw.githubusercontent.com/zabbix/community-templates/main/Network_Devices/Palo_Alto/template_palo_alto_with_64-bit_counters_(snmpv2)/5.4/template_palo_alto_with_64-bit_counters_(snmpv2).yaml">Download</a>
      </div>
      
      



<h1 id="palo-alto-snmpv2-64-bit-counters">Palo Alto SNMPv2 64-bit counters</h1>

<h2 id="overview">Overview</h2>

<p>Hi everyone,</p>

<p>I created this template because i updated two Palo Alto from 8.1.4 to 9.0.3 and some counter went from 32 to 64bits</p>

<p>I just modified the template below from Pavol Rehak so check it out (for details details and trap configuration) :</p>

<p><a href="network_devices/palo-alto/paloalto-snmpv3-zabbix4-0">https://share.zabbix.com/network_devices/palo-alto/paloalto-snmpv3-zabbix4-0</a></p>

<p>I changed all snmpv3 to snmpv2 and added graphs for discovered interface traffic (in &amp; out)</p>

<p>I had some error on storage discovery too that i fixed</p>

<p>###</p>

<p>NAME : Template Palo Alto SNMPv2 64-bit counters</p>

<p>###</p>

<p>TESTED : zabbix 4.2 and PAN OS 9.0.3-h3 but should work on zabbix 3.4 and PAN OS 8.1</p>

<h2 id="author">Author</h2>

<p>Remi Chanoine</p>

<h2 id="macros-used">Macros used</h2>

<p>There are no macros links in this template.</p>

<h2 id="template-links">Template links</h2>

<p>There are no template links in this template.</p>

<h2 id="discovery-rules">Discovery rules</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>interface discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>hrStorage discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>entPhysical discovery - Fan</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery.fan&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>CPU discovery</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceDescr.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>entPhysical discovery - Temperature</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalName.discovery&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="items-collected">Items collected</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Type</th>
      <th>Key and additional info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Device description</td>
      <td>&lt;p&gt;A textual description of the entity. This value should include the full name and version identification of the system’s hardware type, software operating-system, and networking software. It is mandatory that this only contain printable ASCII characters.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysDescr.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Hostname</td>
      <td>&lt;p&gt;An administratively-assigned name for this managed node. By convention, this is the node’s fully-qualified domain name.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>sysName.0&lt;p&gt;Update: 1d&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA peer state</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAPeerState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>General trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“General trap”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA mode</td>
      <td>&lt;p&gt;Current high-availability peer state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAMode.0&lt;p&gt;Update: 12h&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Undefined traps</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap.fallback&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA state</td>
      <td>&lt;p&gt;Current high-availability state.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>panSysHAState.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>HA status trap</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“HA link change”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>System shutdown</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP trap</code></td>
      <td>snmptrap[“System shutdown”]&lt;p&gt;Update: 0&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>Uptime</td>
      <td>&lt;p&gt;“The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrSystemUptime.0&lt;p&gt;Update: 1m&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 admin status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAdminStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 alias (description)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifAlias.[”{#IFNAME}”]&lt;p&gt;Update: 6h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 input traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCInOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 output traffic (30 sec)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifHCOutOctets.[”{#IFNAME}”]&lt;p&gt;Update: 30s&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 link status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>ifOperStatus.[”{#IFNAME}”]&lt;p&gt;Update: 2m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage size</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageSize.[”{#STOR}”]&lt;p&gt;Update: 30m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage type</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageType.[”{#STOR}”]&lt;p&gt;Update: 12h&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 storage used</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrStorageUsed.[”{#STOR}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.fan.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.fan.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} status</td>
      <td>&lt;p&gt;“The current operational state of the device described by this row of the table. A value unknown(1) indicates that the current state of the device is unknown. running(2) indicates that the device is up and running and that no unusual error conditions are known. The warning(3) state indicates that agent has been informed of an unusual error condition by the operational software (e.g., a disk device driver) but that the device is still ‘operational’. An example would be a high number of soft errors on a disk. A value of testing(4), indicates that the device is not available for use because it is in the testing state. The state of down(5) is used only when the agent has been informed that the device is not available for any use.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrDeviceStatus.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>{#CPU} load - percentage</td>
      <td>&lt;p&gt;“The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>hrProcessorLoad.[”{#CPU}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 opration status</td>
      <td>&lt;p&gt;“The operational status of the sensor.”&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorOperStatus.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor value</td>
      <td>&lt;p&gt;The most recent measurement obtained by the agent for this sensor.&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhySensorValue.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 class</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalClass.[”{#PHY}”]&lt;p&gt;Update: 1m&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
    <tr>
      <td>$1 sensor description</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td><code class="language-plaintext highlighter-rouge">SNMP agent</code></td>
      <td>entPhysicalDescr.[”{#PHY}”]&lt;p&gt;Update: 1d&lt;/p&gt;&lt;p&gt;LLD&lt;/p&gt;</td>
    </tr>
  </tbody>
</table>

<h2 id="triggers">Triggers</h2>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Expression</th>
      <th>Priority</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.fan.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95%</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR}</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/ifAdminStatus.[”{#IFNAME}”])=1 and last(/Palo Alto SNMPv2 64-bit counters/ifOperStatus.[”{#IFNAME}”])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#IFNAME} interface down (LLD)</td>
      <td>&lt;p&gt;interface ifAdminStatus is up(1) and ifOperStatus is down(2)&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/ifAdminStatus.[”{#IFNAME}”])=1 and last(/Palo Alto SNMPv2 64-bit counters/ifOperStatus.[”{#IFNAME}”])=2&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 2% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 98&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
    <tr>
      <td>Free disk space is less than 5% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>Free disk space is less than 10% on {#STOR} (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrStorageUsed.[”{#STOR}”]) / last(/Palo Alto SNMPv2 64-bit counters/hrStorageSize.[”{#STOR}”]) * 100 &gt; 90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.fan.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status down (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=5&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#CPU} status warning (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrDeviceStatus.[”{#CPU}”])=3&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>warning</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 90% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;90&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>CPU load on {#CPU} more than 95% (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/hrProcessorLoad.[”{#CPU}”])&gt;95&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} sensor status not ok (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorOperStatus.[”{#PHY}”])&lt;&gt;1&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 65 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;65&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>average</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 70 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;70&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>high</td>
    </tr>
    <tr>
      <td>{#PHY} temperature above 80 °C (LLD)</td>
      <td>&lt;p&gt;-&lt;/p&gt;</td>
      <td>&lt;p&gt;<strong>Expression</strong>: last(/Palo Alto SNMPv2 64-bit counters/entPhySensorValue.[”{#PHY}”])&gt;80&lt;/p&gt;&lt;p&gt;<strong>Recovery expression</strong>: &lt;/p&gt;</td>
      <td>disaster</td>
    </tr>
  </tbody>
</table>


    </div>
    
  </div>
  <script>
    (function () {
      
      //console.log('#content_ver_5_4');
      //console.log('#ver_5_4');
      $('.readme').hide();
      $('#content_ver_5_4').fadeIn('slow');
      $('#ver_5_4').addClass('active');

      
      $('#ver_5_0').click(function () {
        //console.log('#content_ver_5_0');
        //console.log('#ver_5_0');
        $('.readme').hide();
        $('#content_ver_5_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_0').addClass('active');
      })
      
      $('#ver_6_0').click(function () {
        //console.log('#content_ver_6_0');
        //console.log('#ver_6_0');
        $('.readme').hide();
        $('#content_ver_6_0').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_6_0').addClass('active');
      })
      
      $('#ver_5_4').click(function () {
        //console.log('#content_ver_5_4');
        //console.log('#ver_5_4');
        $('.readme').hide();
        $('#content_ver_5_4').fadeIn('slow');
        $('.js_tab').removeClass('active')
        $('#ver_5_4').addClass('active');
      })
      
    })();
  </script>
</body>

</html>